

<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>OtterCTF 2018 内存取证复现 &middot; OPdbg</title>
  <meta name="title" content="OtterCTF 2018 内存取证复现 &middot; OPdbg" />
  
  
  
  
  
  <link rel="canonical" href="https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.69dfbd88ef7129902eaf1aee00660b4e9203142083f65f0194c832847f8b2a3782d909a54a812b51f6d40fbc4f9361ef007efd6259112be1875826f850711dd5.css"
    integrity="sha512-ad&#43;9iO9xKZAurxruAGYLTpIDFCCD9l8BlMgyhH&#43;LKjeC2QmlSoErUfbUD7xPk2HvAH79YlkRK&#43;GHWCb4UHEd1Q==" />
  
  
  <script type="text/javascript" src="/js/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js" integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP&#43;DGNKHfuwvY7kxvUdBeoGlODJ6&#43;SfaPg=="></script>
  
  
  <script type="text/javascript" src="/js/appearance.min.f94f4c4636d9e3ec8f5ee53cdc8ffa3d01bf87cd92ac85e6797550b1e2b80dc9118d838f3eb24c55109352455e72ff082dfe560283154e5a8f87fd75107b59c4.js"
    integrity="sha512-&#43;U9MRjbZ4&#43;yPXuU83I/6PQG/h82SrIXmeXVQseK4DckRjYOPPrJMVRCTUkVecv8ILf5WAoMVTlqPh/11EHtZxA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.3505add38a70acba51f9557ef4857df3e22668f612f62e52b3d5c4206205c5466595b8aeab4e238ac2225b9ff74bff24fee5b8d68940264e5bac7d35f1d7d7b5.js"
    integrity="sha512-NQWt04pwrLpR&#43;VV&#43;9IV98&#43;ImaPYS9i5Ss9XEIGIFxUZllbiuq04jisIiW5/3S/8k/uW41olAJk5brH018dfXtQ==" data-copy="" data-copied=""></script>
  
  <script src="/js/zoom.min.js"></script>
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="OtterCTF 2018 内存取证复现" />
<meta property="og:description" content="OtterCTF 2018 Memory Forensic Reappearance # 想学习并练习下电子取证技术，经过网络上的一番搜索发现OtterCTF的取证题目非常有意思，这次尝试练习下内存取证的题目顺便学习下内存取证的相关内容和技能点。内存取证主要使用的工具是Volatility，githu上面有相关项目。Volatility有两个版本分别是用python2和python3进行构建的，目前主要的组件还是以python2为主。 Volatility项目地址：https://github.com/volatilityfoundation/volatility Volatility3项目地址：https://github.com/volatilityfoundation/volatility3
环境配置：Kali Linux 2022 工具配置：volatility &#43; mimikatz
Info # 题目附件就一个镜像，先查看下镜像的指纹数据：
5b3d8a9f9c96581a821c19b71dd6aa80dd299fc674b818f443f3a6fb5495a872 OtterCTF.vmem 使用vol简单查看下镜像信息数据，查看数据的指令：
vol.py -f OtterCTF.vmem imageinfo 说明
vol.py volatility程序 -f OtterCTF.vmem 加载OtterCTF.vmem内存镜像文件 imageinfo 查看内存镜像的基本信息 得到如下信息：
可以看到大致的镜像系统是Win7系统
What the password? # 查看题目描述：
you got a sample of rick&#39;s PC&#39;s memory. can you get his user password? 要得到用户名的密码，先获取到hash数据，使用获取hash的指令：
vol.py -f OtterCTF.vmem --profile=Win7SP1x64 hashdump --profile=Win7SP1x64 设置配置为Win7SP1x64配置 hashdump 从内存中dump出密码的hash信息 得到hash信息：
对于这种hash信息可以使用mimikatz插件，或者使用hashcat也可以，这里使用mimikatz进行获取
使用如下指令使用mimikatz插件进行获取：
vol.py -f OtterCTF.vmem --profile=Win7SP1x64 mimikatz 得到如下信息：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-04T23:18:37+08:00" />
<meta property="article:modified_time" content="2022-10-04T23:18:37+08:00" /><meta property="og:site_name" content="OPdbg" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="OtterCTF 2018 内存取证复现"/>
<meta name="twitter:description" content="OtterCTF 2018 Memory Forensic Reappearance # 想学习并练习下电子取证技术，经过网络上的一番搜索发现OtterCTF的取证题目非常有意思，这次尝试练习下内存取证的题目顺便学习下内存取证的相关内容和技能点。内存取证主要使用的工具是Volatility，githu上面有相关项目。Volatility有两个版本分别是用python2和python3进行构建的，目前主要的组件还是以python2为主。 Volatility项目地址：https://github.com/volatilityfoundation/volatility Volatility3项目地址：https://github.com/volatilityfoundation/volatility3
环境配置：Kali Linux 2022 工具配置：volatility &#43; mimikatz
Info # 题目附件就一个镜像，先查看下镜像的指纹数据：
5b3d8a9f9c96581a821c19b71dd6aa80dd299fc674b818f443f3a6fb5495a872 OtterCTF.vmem 使用vol简单查看下镜像信息数据，查看数据的指令：
vol.py -f OtterCTF.vmem imageinfo 说明
vol.py volatility程序 -f OtterCTF.vmem 加载OtterCTF.vmem内存镜像文件 imageinfo 查看内存镜像的基本信息 得到如下信息：
可以看到大致的镜像系统是Win7系统
What the password? # 查看题目描述：
you got a sample of rick&#39;s PC&#39;s memory. can you get his user password? 要得到用户名的密码，先获取到hash数据，使用获取hash的指令：
vol.py -f OtterCTF.vmem --profile=Win7SP1x64 hashdump --profile=Win7SP1x64 设置配置为Win7SP1x64配置 hashdump 从内存中dump出密码的hash信息 得到hash信息：
对于这种hash信息可以使用mimikatz插件，或者使用hashcat也可以，这里使用mimikatz进行获取
使用如下指令使用mimikatz插件进行获取：
vol.py -f OtterCTF.vmem --profile=Win7SP1x64 mimikatz 得到如下信息："/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "OtterCTF 2018 内存取证复现",
    "headline": "OtterCTF 2018 内存取证复现",
    
    "abstract": "OtterCTF 2018 Memory Forensic Reappearance # 想学习并练习下电子取证技术，经过网络上的一番搜索发现OtterCTF的取证题目非常有意思，这次尝试练习下内存取证的题目顺便学习下内存取证的相关内容和技能点。内存取证主要使用的工具是Volatility，githu上面有相关项目。Volatility有两个版本分别是用python2和python3进行构建的，目前主要的组件还是以python2为主。 Volatility项目地址：https:\/\/github.com\/volatilityfoundation\/volatility Volatility3项目地址：https:\/\/github.com\/volatilityfoundation\/volatility3\n环境配置：Kali Linux 2022 工具配置：volatility \u002b mimikatz\nInfo # 题目附件就一个镜像，先查看下镜像的指纹数据：\n5b3d8a9f9c96581a821c19b71dd6aa80dd299fc674b818f443f3a6fb5495a872 OtterCTF.vmem 使用vol简单查看下镜像信息数据，查看数据的指令：\nvol.py -f OtterCTF.vmem imageinfo 说明\nvol.py volatility程序 -f OtterCTF.vmem 加载OtterCTF.vmem内存镜像文件 imageinfo 查看内存镜像的基本信息 得到如下信息：\n可以看到大致的镜像系统是Win7系统\nWhat the password? # 查看题目描述：\nyou got a sample of rick\u0026#39;s PC\u0026#39;s memory. can you get his user password? 要得到用户名的密码，先获取到hash数据，使用获取hash的指令：\nvol.py -f OtterCTF.vmem --profile=Win7SP1x64 hashdump --profile=Win7SP1x64 设置配置为Win7SP1x64配置 hashdump 从内存中dump出密码的hash信息 得到hash信息：\n对于这种hash信息可以使用mimikatz插件，或者使用hashcat也可以，这里使用mimikatz进行获取\n使用如下指令使用mimikatz插件进行获取：\nvol.py -f OtterCTF.vmem --profile=Win7SP1x64 mimikatz 得到如下信息：",
    "inLanguage": "en",
    "url" : "https:\/\/www.codetea.top\/posts\/otterctf_2018_memory_forensic_writeup\/",
    "author" : {
      "@type": "Person",
      "name": "OolongCode"
    },
    "copyrightYear": "2022",
    "dateCreated": "2022-10-04T23:18:37\u002b08:00",
    "datePublished": "2022-10-04T23:18:37\u002b08:00",
    
    "dateModified": "2022-10-04T23:18:37\u002b08:00",
    
    "keywords": ["ctf","Forensics","writeup"],
    
    "mainEntityOfPage": "true",
    "wordCount": "804"
  }]
  </script>


  
  
  <meta name="author" content="OolongCode" />
  
  
  






  
  
  
  


  
  
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  
  
  
</head><body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400"
          >&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <div style="padding-left:0;padding-right:0"
    class="flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">OPdbg</a>
            
            
        </nav>
        <div class="hidden md:flex items-center space-x-5 md:ml-12">

            
            
            <a href="/about/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="About">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


                 &nbsp; 
                About
            </a>
            
            <a href="/posts/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="Posts">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


                 &nbsp; 
                Posts
            </a>
            
            <a href="/link/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="Link">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>


                 &nbsp; 
                Link
            </a>
            
            <a href="https://github.com/OolongCode" class="text-base font-medium text-gray-500 hover:text-gray-900" title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                
                
            </a>
            
            

            


            
            <button id="search-button" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            
            <div
                class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
                <button id="appearance-switcher" type="button">
                    <div class="flex items-center justify-center h-12 dark:hidden">
                        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden h-12 dark:flex">
                        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </div>
        <div class="flex md:hidden items-center space-x-5 md:ml-12">

            <span></span>

            


            
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" type="button" style="margin-right:5px">
                <div class="flex items-center justify-center h-12 dark:hidden">
                    

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden h-12 dark:flex">
                    

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:25px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
                    <li class="mb-1">
                        <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/about/" title="About">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


                             &nbsp; 
                            About
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/posts/" title="Posts">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


                             &nbsp; 
                            Posts
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/link/" title="Link">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>


                             &nbsp; 
                            Link
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="https://github.com/OolongCode" title="">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                            
                            
                        </a>
                    </li>
                    
                    

                </ul>
            </div>
        </label>
    </div>
</div>


<div id="mobile-menu"
    class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
    <ul
        class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
        <li class="mb-1">
            <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
        </li>
        
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/about/" title="About">About</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/" title="Posts">Posts</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/link/" title="Link">Link</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="https://github.com/OolongCode" title=""></a>
        </li>
        
        
        
        <li>
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
        </li>
        
    </ul>
</div>
    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
<article>
  <header class="max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >OPdbg</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/otterctf_2018_memory_forensic_writeup/"
      >OtterCTF 2018 内存取证复现</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      OtterCTF 2018 内存取证复现
    </h1>
    <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      






































<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2022-10-04 23:18:37 &#43;0800 CST">October 4, 2022</time><span class="px-2 text-primary-500">&middot;</span><span>804 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">4 mins</span><span class="px-2 text-primary-500">&middot;</span>


  
    
  
  

<span class="mb-[2px]">
  <a
    href="#/posts/OtterCTF_2018_Memory_Forensic_writeup.md"
    class="text-lg hover:text-primary-500"
    rel="noopener noreferrer"
    target="_blank"
    title="Edit content"
    >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M490.3 40.4C512.2 62.27 512.2 97.73 490.3 119.6L460.3 149.7L362.3 51.72L392.4 21.66C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7L339.7 74.34L437.7 172.3L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2L159.6 382.8C150.1 385.6 141.5 383.4 135 376.1C128.6 370.5 126.4 361 129.2 352.4L158.8 263.6C161.6 255.3 166.2 247.8 172.4 241.7V241.7zM192 63.1C209.7 63.1 224 78.33 224 95.1C224 113.7 209.7 127.1 192 127.1H96C78.33 127.1 64 142.3 64 159.1V416C64 433.7 78.33 448 96 448H352C369.7 448 384 433.7 384 416V319.1C384 302.3 398.3 287.1 416 287.1C433.7 287.1 448 302.3 448 319.1V416C448 469 405 512 352 512H96C42.98 512 0 469 0 416V159.1C0 106.1 42.98 63.1 96 63.1H192z"/></svg>

  </span>

</a
  >
</span>
  

  
  



</div>






    </div>
  </header>
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
     <div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">
        <details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#info">Info</a></li>
    <li><a href="#what-the-password">What the password?</a></li>
    <li><a href="#general-info">General Info</a></li>
    <li><a href="#play-time">Play Time</a></li>
    <li><a href="#name-game">Name Game</a></li>
    <li><a href="#name-game-2">Name Game 2</a>
      <ul>
        <li><a href="#method-1">Method 1</a></li>
        <li><a href="#method-2">Method 2</a></li>
      </ul>
    </li>
    <li><a href="#silly-rick">Silly Rick</a></li>
    <li><a href="#hide-and-seek">Hide And Seek</a></li>
    <li><a href="#path-to-glory">Path To Glory</a></li>
    <li><a href="#path-to-glory-2">Path To Glory 2</a></li>
    <li><a href="#bit-4-bit">Bit 4 Bit</a></li>
    <li><a href="#graphics-for-the-weak">Graphic’s For The Weak</a></li>
    <li><a href="#recovery">Recovery</a></li>
    <li><a href="#closure">Closure</a>
      <ul>
        <li><a href="#hiddenteardecrypt工具解密">HiddenTearDecrypt工具解密</a></li>
        <li><a href="#解密脚本解密">解密脚本解密</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#info">Info</a></li>
    <li><a href="#what-the-password">What the password?</a></li>
    <li><a href="#general-info">General Info</a></li>
    <li><a href="#play-time">Play Time</a></li>
    <li><a href="#name-game">Name Game</a></li>
    <li><a href="#name-game-2">Name Game 2</a>
      <ul>
        <li><a href="#method-1">Method 1</a></li>
        <li><a href="#method-2">Method 2</a></li>
      </ul>
    </li>
    <li><a href="#silly-rick">Silly Rick</a></li>
    <li><a href="#hide-and-seek">Hide And Seek</a></li>
    <li><a href="#path-to-glory">Path To Glory</a></li>
    <li><a href="#path-to-glory-2">Path To Glory 2</a></li>
    <li><a href="#bit-4-bit">Bit 4 Bit</a></li>
    <li><a href="#graphics-for-the-weak">Graphic’s For The Weak</a></li>
    <li><a href="#recovery">Recovery</a></li>
    <li><a href="#closure">Closure</a>
      <ul>
        <li><a href="#hiddenteardecrypt工具解密">HiddenTearDecrypt工具解密</a></li>
        <li><a href="#解密脚本解密">解密脚本解密</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

      </div>
      </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <h1 id="otterctf-2018-memory-forensic-reappearance" class="relative group">OtterCTF 2018 Memory Forensic Reappearance <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#otterctf-2018-memory-forensic-reappearance" aria-label="Anchor">#</a></span></h1>
<p>想学习并练习下电子取证技术，经过网络上的一番搜索发现OtterCTF的取证题目非常有意思，这次尝试练习下内存取证的题目顺便学习下内存取证的相关内容和技能点。内存取证主要使用的工具是Volatility，githu上面有相关项目。Volatility有两个版本分别是用python2和python3进行构建的，目前主要的组件还是以python2为主。
Volatility项目地址：<a href="https://github.com/volatilityfoundation/volatility">https://github.com/volatilityfoundation/volatility</a>
Volatility3项目地址：<a href="https://github.com/volatilityfoundation/volatility3">https://github.com/volatilityfoundation/volatility3</a></p>
<p>环境配置：Kali Linux 2022
工具配置：volatility + mimikatz</p>
<h2 id="info" class="relative group">Info <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#info" aria-label="Anchor">#</a></span></h2>
<p>题目附件就一个镜像，先查看下镜像的指纹数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>5b3d8a9f9c96581a821c19b71dd6aa80dd299fc674b818f443f3a6fb5495a872  OtterCTF.vmem
</span></span></code></pre></div><p>使用vol简单查看下镜像信息数据，查看数据的指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem imageinfo
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>vol.py</code> volatility程序</li>
<li><code>-f OtterCTF.vmem</code>  加载<code>OtterCTF.vmem</code>内存镜像文件</li>
<li><code>imageinfo</code> 查看内存镜像的基本信息</li>
</ul>
</blockquote>
<p>得到如下信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221002204848160.png" alt="image-20221002204848160" />
      
    </figure>
  

</p>
<p>可以看到大致的镜像系统是Win7系统</p>
<h2 id="what-the-password" class="relative group">What the password? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#what-the-password" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>you got a sample of rick&#39;s PC&#39;s memory. can you get his user password?
</span></span></code></pre></div><p>要得到用户名的密码，先获取到hash数据，使用获取hash的指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 hashdump  
</span></span></code></pre></div><blockquote>
<ul>
<li><code>--profile=Win7SP1x64</code> 设置配置为<code>Win7SP1x64</code>配置</li>
<li><code>hashdump</code> 从内存中dump出密码的hash信息</li>
</ul>
</blockquote>
<p>得到hash信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221002212051508.png" alt="image-20221002212051508" />
      
    </figure>
  

</p>
<p>对于这种hash信息可以使用mimikatz插件，或者使用hashcat也可以，这里使用mimikatz进行获取</p>
<p>使用如下指令使用mimikatz插件进行获取：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 mimikatz
</span></span></code></pre></div><p>得到如下信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221002214545148.png" alt="image-20221002214545148" />
      
    </figure>
  

</p>
<p>已经获取到了密码信息，提交flag，攻破此题：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CTF{MortyIsReallyAnOtter}
</span></span></code></pre></div><h2 id="general-info" class="relative group">General Info <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#general-info" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Let&#39;s start easy - whats the PC&#39;s name and IP address?
</span></span></code></pre></div><p>需要获取PC’s name和IP， PC的名字已经很明确了，应该就是刚刚获取密码信息得到的<code>WIN-LO6FAF3DTFE</code></p>
<p>下面需要获取的应该就是IP地址，使用网络扫描指令应该可以获取到相应的信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003001348636.png" alt="image-20221003001348636" />
      
    </figure>
  

</p>
<p>可以看出IP地址应该是：<code>192.168.202.131</code></p>
<p>根据题目要求，flag应该是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CTF{WIN-LO6FAF3DTFE}
</span></span><span style="display:flex;"><span>CTF{192.168.202.131}
</span></span></code></pre></div><h2 id="play-time" class="relative group">Play Time <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#play-time" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Rick just loves to play some good old videogames.
</span></span><span style="display:flex;"><span>can you tell which game is he playing?
</span></span><span style="display:flex;"><span>whats the IP address of the server?
</span></span></code></pre></div><p>玩游戏肯定会有进程的存储在内存中，扫描下进程情况，使用如下指令进行查看：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 psscan
</span></span></code></pre></div><p>得到如下信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003002817020.png" alt="image-20221003002817020" />
      
    </figure>
  

</p>
<p>可以发现到了一个不熟悉的进程，猜测这个进程是游戏进程，也就是游戏名称是<code>LunarMS.exe</code></p>
<p>再使用<code>netscan</code>查看下网络通信信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003003940157.png" alt="image-20221003003940157" />
      
    </figure>
  

</p>
<p>可以发现一个ip地址，应该是游戏下载的ip地址，可以得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CTF{LunarMS.exe}
</span></span><span style="display:flex;"><span>CTF{77.102.199.102}
</span></span></code></pre></div><h2 id="name-game" class="relative group">Name Game <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#name-game" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>We know that the account was logged in to a channel called Lunar-3. what is the account name?
</span></span></code></pre></div><p>应该需要找到游戏的用户名，应该存储在游戏的内存中，尝试将游戏进程进行dump来获取到游戏进程的内存信息</p>
<p>vol程序进行内存dump的指令如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 memdump -p <span style="color:#ae81ff">708</span> -D ./
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>memdump</code> 内存dump的命令</li>
<li><code>-p 708</code> 指定PID号708的进程</li>
<li><code>-D ./</code> 指定内存dump进程文件存储位置</li>
</ul>
</blockquote>
<p>运行指令得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003014902581.png" alt="image-20221003014902581" />
      
    </figure>
  

</p>
<p>尝试检索dump出来的文件的字符串，使用如下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings 708.dmp | grep Lunar-3
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>strings 708.dmp</code> 打印出<code>708.dmp</code>二进制文件中的可打印字符</li>
<li><code>|</code>  管道符，可以将左边命令输出的数据传递右边的命令处理</li>
<li><code>grep Lunar-3</code> 检索有<code>Lunar</code>字符串所在的行并打印</li>
</ul>
</blockquote>
<p>运行命令得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003015212113.png" alt="image-20221003015212113" />
      
    </figure>
  

</p>
<p>发现是存在相关字符串内容，增加点参数来获得字符串的上下文内容，执行如下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings 708.dmp | grep Lunar-3 -A <span style="color:#ae81ff">3</span> -B <span style="color:#ae81ff">3</span>
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>-A 3</code> 检索字符串所在行的前3行</li>
<li><code>-B 3</code> 检索字符串所在行的后3行</li>
</ul>
</blockquote>
<p>执行命令得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003020425640.png" alt="image-20221003020425640" />
      
    </figure>
  

</p>
<p>发现存在可疑字符串：<code>0tt3r8r33z3</code></p>
<p>感觉这个字符串应该就是用户名，尝试提交成功</p>
<p>故flag是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CTF{0tt3r8r33z3}
</span></span></code></pre></div><h2 id="name-game-2" class="relative group">Name Game 2 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#name-game-2" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>From a little research we found that the username of the logged on character is always after this signature: 0x64 0x??{6-8} 0x40 0x06 0x??{18} 0x5a 0x0c 0x00{2}
</span></span><span style="display:flex;"><span>What&#39;s rick&#39;s character&#39;s name?
</span></span></code></pre></div><p>这道题目应该寻找相关的字符，需要进行模糊搜索</p>
<p>这道题目有两种解题方法：</p>
<ol>
<li>使用Linux的<code>hexdump</code>和<code>grep</code>命令来进行联合检索</li>
<li>使用Hexedit类工具进行逐一寻找来确定相应位置</li>
</ol>
<h3 id="method-1" class="relative group">Method 1 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#method-1" aria-label="Anchor">#</a></span></h3>
<p>使用如下Linux命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hexdump -C 708.dmp | grep <span style="color:#e6db74">&#34;64&#34;</span> -A <span style="color:#ae81ff">5</span> -B <span style="color:#ae81ff">5</span> | grep <span style="color:#e6db74">&#34;40 06&#34;</span> -A <span style="color:#ae81ff">5</span> -B <span style="color:#ae81ff">5</span> | grep <span style="color:#e6db74">&#34;5a 0c 00 00&#34;</span> -A <span style="color:#ae81ff">5</span> -B <span style="color:#ae81ff">5</span>
</span></span></code></pre></div><p>执行命令获得：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003113309491.png" alt="image-20221003113309491" />
      
    </figure>
  

</p>
<p>由于dump文件比较大，因此，这个命令可能需要执行4-5min才能执行出来结果，运行命令比较简单，但是运行时间相对比较长。</p>
<p>运行得到的字符串就是<code>M0rtyL0L</code></p>
<p>故此题的flag就是<code>CTF{M0rtyL0L}</code></p>
<h3 id="method-2" class="relative group">Method 2 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#method-2" aria-label="Anchor">#</a></span></h3>
<p>使用WinHex之类的工具进行查看搜索<code>5a0c0000</code></p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003115058149.png" alt="image-20221003115058149" />
      
    </figure>
  

</p>
<p>进行Hex value的搜索，依次对搜索列表进行比对和寻找：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003115148926.png" alt="image-20221003115148926" />
      
    </figure>
  

</p>
<p>最后找到目标位置：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003115217012.png" alt="image-20221003115217012" />
      
    </figure>
  

</p>
<p>这种方式要进行查找比对，查找速度快的话是比Linux命令要快些，但是就是需要不断的人工比对和查看</p>
<p>得到字符串<code>M0rtyL0L</code></p>
<p>故此题的flag就是<code>CTF{M0rtyL0L}</code></p>
<p>这两种解题方法各有利弊，可以根据个人的喜好选择求解，个人更倾向于Linux那种解法，输入完命令就可以喝杯茶慢慢等，一会儿结果就出来了</p>
<h2 id="silly-rick" class="relative group">Silly Rick <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#silly-rick" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Silly rick always forgets his email&#39;s password, so he uses a Stored Password Services online to store his password. He always copy and paste the password so he will not get it wrong. whats rick&#39;s email password?
</span></span></code></pre></div><p>根据题目描述，可以确定的关键语句<code>copy and paste</code>，说明邮箱地址应该是存储在粘贴板上面，可以查看下内存的粘贴板。</p>
<p>使用vol的如下指令查看粘贴板信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003131135095.png" alt="image-20221003131135095" />
      
    </figure>
  

</p>
<p>可以发现的粘贴板信息：<code>M@il_Pr0vid0rs</code></p>
<p>故此题的flag就是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CTF{M@il_Pr0vid0rs}
</span></span></code></pre></div><h2 id="hide-and-seek" class="relative group">Hide And Seek <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#hide-and-seek" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>The reason that we took rick&#39;s PC memory dump is because there was a malware infection. Please find the malware process name (including the extension)
</span></span></code></pre></div><p>根据题目描述，应该是需要寻找下恶意软件进程名称，vol这个软件功能非常强大，可以直接使用<code>malfind</code>的参数进行扫描，使用如下指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 malfind | grep Process
</span></span></code></pre></div><p>得到恶意进程信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221003180849409.png" alt="image-20221003180849409" />
      
    </figure>
  

</p>
<p>可以简单的归纳下恶意进程的信息：</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Pid</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WmiPrvSE.exe</code></td>
<td>2136</td>
</tr>
<tr>
<td><code>explorer.exe</code></td>
<td>2728</td>
</tr>
<tr>
<td><code>BitTorrent.exe</code></td>
<td>2836</td>
</tr>
<tr>
<td><code>PresentationFo</code></td>
<td>724</td>
</tr>
<tr>
<td><code>mscorsvw.exe</code></td>
<td>412</td>
</tr>
<tr>
<td><code>mscorsvw.exe</code></td>
<td>3124</td>
</tr>
<tr>
<td><code>svchost.exe</code></td>
<td>3196</td>
</tr>
<tr>
<td><code>chrome.exe</code></td>
<td>4076</td>
</tr>
<tr>
<td><code>vmware-tray.ex</code></td>
<td>3720</td>
</tr>
<tr>
<td><code>WebCompanionIn</code></td>
<td>3880</td>
</tr>
<tr>
<td><code>Lavasoft.WCAss</code></td>
<td>3496</td>
</tr>
<tr>
<td><code>WebCompanion.e</code></td>
<td>3856</td>
</tr>
</tbody>
</table>
<p>这些是可能的恶意进程，需要找到题目要求的恶意进程，看看进程的cmd指令，使用如下指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 cmdline
</span></span></code></pre></div><p>得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004150006413.png" alt="image-20221004150006413" />
      
    </figure>
  

</p>
<p>可以看到有一个进程是在Temp目录下进行执行，这个进程应该就是恶意进程了，一般恶意进程会在Temp目录中运行。</p>
<p>故恶意进程就是<code>vmware-tray.exe</code></p>
<p>故此题的flag就是<code>CTF{vmware-tray.exe}</code></p>
<h2 id="path-to-glory" class="relative group">Path To Glory <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#path-to-glory" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>How did the malware got to rick&#39;s PC? It must be one of rick old illegal habits...
</span></span></code></pre></div><p>应该是要寻找的Rick的不良习惯，进行文件扫描来尝试确定可疑的文件</p>
<p>文件扫描使用<code>filescan</code>指令，由于是要寻找Rick的文件需要进行简单过滤下，使用如下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 filescan | grep -i <span style="color:#e6db74">&#34;Rick&#34;</span>
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>grep -i &quot;Rick&quot;</code> 忽略大小写检索<code>Rick</code></li>
</ul>
</blockquote>
<p>得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004163351355.png" alt="image-20221004163351355" />
      
    </figure>
  

</p>
<p>发现一个torrent文件，可以猜测Rick应该平时会进行torrent种子文件的下载，而且这个种子文件的位置一般是在<code>Rick And Morty</code>文件夹下面。因此，进一步过滤查看相关信息，使用如下指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 filescan | grep -i <span style="color:#e6db74">&#34;Rick And Morty&#34;</span>
</span></span></code></pre></div><p>得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004164710378.png" alt="image-20221004164710378" />
      
    </figure>
  

</p>
<p>发现有一个文件的权限比较可疑，尝试将这个文件进行dump，来查看文件具体信息</p>
<p>使用如下命令进行dump：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 dumpfiles -Q 0x000000007dae9350 -D ./
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>dumpfiles</code> dump文件指令</li>
<li><code>-Q 0x000000007dae9350 </code> 以物理偏移为<code>0x000000007dae9350</code>的文件作为对象</li>
<li><code>-D ./</code> dump文件目录在<code>./</code>目录下</li>
</ul>
</blockquote>
<p>得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004170421613.png" alt="image-20221004170421613" />
      
    </figure>
  

</p>
<p>查看下dump文件中的可打印字符串数据</p>
<p>执行如下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings file.None.0xfffffa801b42c9e0.dat
</span></span></code></pre></div><p>得到可打印字符串信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004170725684.png" alt="image-20221004170725684" />
      
    </figure>
  

</p>
<p>故此题的flag应该是藏在<code>e7:website19:M3an_T0rren7_4_R!cke</code>这段字符串中，对这段字符串仔细观察，可以发现这段字符串是有一些明显特征的</p>
<p>可以发现<code>e</code>是作为开头结尾的引用，中间的数据就是<code>7:website19:M3an_T0rren7_4_R!ck</code>，应该是三个对象显然最后一个对象应该是就是flag</p>
<p>故此题的flag就是<code>CTF{M3an_T0rren7_4_R!ck}</code></p>
<h2 id="path-to-glory-2" class="relative group">Path To Glory 2 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#path-to-glory-2" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Continue the search after the way that malware got in.
</span></span></code></pre></div><p>需要继续寻找关于恶意软件的信息，要往深入探索应该需要探索浏览器的相关信息，由于Rick被恶意攻击是由于Rick在浏览器上下载种子文件</p>
<p>把浏览器的进程内存dump出来查看关键的信息</p>
<p>使用如下指令来dump相关信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 memdump -n chrome -D ./f/
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>memdump</code> dump内存命令</li>
<li><code>-n chrome</code> 以进程名称作为内存对象</li>
<li><code>-D ./f/</code> dump内存文件<code>./f/</code>目录</li>
</ul>
</blockquote>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004201432915.png" alt="image-20221004201432915" />
      
    </figure>
  

</p>
<p>使用<code>strings</code>命令来获取内存文件的可打印字符串，并添加<code>download.exe.torrent</code>作为过滤，由于恶意文件名是<code>download.exe.torrent</code>，因此采用这种方式进行过滤</p>
<p>使用如下指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings ./f/* | grep <span style="color:#e6db74">&#34;download\.exe\.torrent&#34;</span> -A <span style="color:#ae81ff">10</span> -B <span style="color:#ae81ff">10</span>
</span></span></code></pre></div><p>得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004204205771.png" alt="image-20221004204205771" />
      
    </figure>
  

</p>
<p>这串字符看样子是挺奇怪的，应该就是flag信息</p>
<p>尝试发现真正的flag数据是<code>Hum@n_I5_Th3_Weak3s7_Link_In_Th3_Ch@in</code></p>
<p>故此题的flag是<code>CTF{Hum@n_I5_Th3_Weak3s7_Link_In_Th3_Ch@in}</code></p>
<h2 id="bit-4-bit" class="relative group">Bit 4 Bit <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#bit-4-bit" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>We&#39;ve found out that the malware is a ransomware. Find the attacker&#39;s bitcoin address.
</span></span></code></pre></div><p>恶意软件是一个勒索软件，需要将那个恶意软件进行分析</p>
<p>首先需要dump出恶意软件的进程，使用<code>procdump</code>将进程dump作为一个可执行程序</p>
<p>使用如下命令进行dump：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile=Win7SP1x64 procdump -p 3720 -D ./
</span></span></code></pre></div><blockquote>
<p><strong>说明</strong></p>
<ul>
<li><code>procdump</code> dump进程作为一个可执行文件</li>
<li><code>-p 3720</code>  以PID作为进程对象</li>
<li><code>-D ./</code>  将可执行文件存储在<code>./</code>目录</li>
</ul>
</blockquote>
<p>得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004210324575.png" alt="image-20221004210324575" />
      
    </figure>
  

</p>
<p>需要对文件进行分析，首先查看软件的相关信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004210448989.png" alt="image-20221004210448989" />
      
    </figure>
  

</p>
<p>发现恶意软件是一个.NET的文件，可以使用dnSpy进行查看，拖进dnSpy进行寻找发现：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004210559036.png" alt="image-20221004210559036" />
      
    </figure>
  

</p>
<p>一个GUI绘制流，根据GUI的代码信息，使用PS绘制出GUI：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004211105657.png" alt="image-20221004211105657" />
      
    </figure>
  

</p>
<p>比特币地址显而易见就是：<code>1MmpEmebJkqXG8nQv4cjJSmxZQFVmFo63M</code></p>
<p>故此题的flag就是<code>CTF{1MmpEmebJkqXG8nQv4cjJSmxZQFVmFo63M}</code></p>
<h2 id="graphics-for-the-weak" class="relative group">Graphic’s For The Weak <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#graphics-for-the-weak" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>There&#39;s something fishy in the malware&#39;s graphics.
</span></span></code></pre></div><p>使用dnSpy加载恶意软件，可以在资源目录中找到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004212217979.png" alt="image-20221004212217979" />
      
    </figure>
  

</p>
<p>故本题的flag就是<code>CTF{S0_Just_M0v3_Socy}</code></p>
<h2 id="recovery" class="relative group">Recovery <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#recovery" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Rick got to have his files recovered! What is the random password used to encrypt the files?
</span></span></code></pre></div><p>对恶意软件进行审计，找到关键的密码发送函数：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004214117780.png" alt="image-20221004214117780" />
      
    </figure>
  

</p>
<p>发现密码是根据计算机名称和用户名以及密码一起发送的，要dump恶意软件的内存信息，使用如下指令进行dump：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 memdump -p <span style="color:#ae81ff">3720</span> -D ./
</span></span></code></pre></div><p>执行命令得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004214626524.png" alt="image-20221004214626524" />
      
    </figure>
  

</p>
<p>使用<code>strings</code>命令进行检索，由于程序的数据是16字节小端序数据，.NET程序的用2字节表示一个字符串，所以是16字节小端序数据，因此使用如下命令进行过滤检索：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings -el 3720.dmp | grep WIN-LO6FAF3DTFE-Rick
</span></span></code></pre></div><p>运行得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004215044513.png" alt="image-20221004215044513" />
      
    </figure>
  

</p>
<p>故此，密码就是<code>aDOBofVYUNVnmp7</code></p>
<p>故此题的flag就是<code>CTF{aDOBofVYUNVnmp7}</code></p>
<h2 id="closure" class="relative group">Closure <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#closure" aria-label="Anchor">#</a></span></h2>
<p>查看题目描述：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Now that you extracted the password from the memory, could you decrypt rick&#39;s files?
</span></span></code></pre></div><p>要找文件并且解密文件。猜测存在一个flag文件，使用如下指令进行文件扫描：</p>
<pre tabindex="0"><code>vol.py -f OtterCTF.vmem --profile=Win7SP1x64 filescan | grep -i &#34;flag&#34;
</code></pre><p>运行命令得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004215615853.png" alt="image-20221004215615853" />
      
    </figure>
  

</p>
<p>应该是桌面上的<code>Flag.txt</code>文件</p>
<p>将文件进行dump，使用如下命令进行文件dump：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ol.py -f OtterCTF.vmem --profile<span style="color:#f92672">=</span>Win7SP1x64 dumpfiles -Q 0x000000007e410890 -D ./
</span></span></code></pre></div><p>运行得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004220208957.png" alt="image-20221004220208957" />
      
    </figure>
  

</p>
<p>下面就需要对文件进行解密了</p>
<p>首先对dnSpy反编译的代码进行审计可以看到是：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004225734265.png" alt="image-20221004225734265" />
      
    </figure>
  

</p>
<p>hidden tear的程序算法</p>
<p>继续进行分析，可以发现一个AES的加密算法：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004230040181.png" alt="image-20221004230040181" />
      
    </figure>
  

</p>
<p>进行跟进分析可以发现一个加密文件的函数：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004230149524.png" alt="image-20221004230149524" />
      
    </figure>
  

</p>
<p>对这两个关键函数进行代码审计发现，核心的加密算法还是AES的算法</p>
<p>根据目前的分析情况，如果要解密这个文件主要有两种思路</p>
<ul>
<li>根据加密算法写解密脚本进行解密</li>
<li>使用HiddenTearDecrypt工具进行解密</li>
</ul>
<h3 id="hiddenteardecrypt工具解密" class="relative group">HiddenTearDecrypt工具解密 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#hiddenteardecrypt%e5%b7%a5%e5%85%b7%e8%a7%a3%e5%af%86" aria-label="Anchor">#</a></span></h3>
<p>由于在文件中发现了HiddenTear的关键信息，可以直接去检索HiddenTearDecrypt:</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004230418792.png" alt="image-20221004230418792" />
      
    </figure>
  

</p>
<p>HiddenTearDecrypt工具在网络上都是可以进行下载的</p>
<p>尝试使用工具进行解密发现不能成功求解。由于加密代码是采用CBC模式进行加密，会对文件进行填充，只要删除掉文件的填充应该就可以正常解密，使用winhex打开文件：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004230652451.png" alt="image-20221004230652451" />
      
    </figure>
  

</p>
<p>可以发现有很多<code>00</code>字节的填充，只要删除<code>00</code>字节的填充就可以进行正常的解密，使用工具进行解密</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221004230849821.png" alt="image-20221004230849821" />
      
    </figure>
  

</p>
<p>解密成功，打开文件得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CTF{Im_Th@_B3S7_RicK_0f_Th3m_4ll}
</span></span></code></pre></div><h3 id="解密脚本解密" class="relative group">解密脚本解密 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e8%a7%a3%e5%af%86%e8%84%9a%e6%9c%ac%e8%a7%a3%e5%af%86" aria-label="Anchor">#</a></span></h3>
<p>由于加密代码已经进行分析，对于加密的情况已经基本清晰</p>
<p>Python编写解密脚本的难点应该是在于生成器的替代，CS中的<code>Rfc2898DeriveBytes</code>可以使用Python中的<code>PBKDF2</code>进行替代</p>
<p>解密脚本主要难度其实已经克服，根据加密写解密脚本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Protocol.KDF <span style="color:#f92672">import</span> PBKDF2
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> sha256
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">AES_Decrypt</span>(c,password):
</span></span><span style="display:flex;"><span>    salt <span style="color:#f92672">=</span> bytes([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>])
</span></span><span style="display:flex;"><span>    kdf <span style="color:#f92672">=</span> PBKDF2(password, salt, <span style="color:#ae81ff">48</span>, count <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>    key <span style="color:#f92672">=</span> kdf[:<span style="color:#ae81ff">32</span>]
</span></span><span style="display:flex;"><span>    iv <span style="color:#f92672">=</span> kdf[<span style="color:#ae81ff">32</span>:]
</span></span><span style="display:flex;"><span>    aes <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key<span style="color:#f92672">=</span>key,iv<span style="color:#f92672">=</span>iv,mode<span style="color:#f92672">=</span>AES<span style="color:#f92672">.</span>MODE_CBC)
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> aes<span style="color:#f92672">.</span>decrypt(c)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> m
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>password <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aDOBofVYUNVnmp7&#34;</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> sha256(password)<span style="color:#f92672">.</span>digest()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./file.dat&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    raw <span style="color:#f92672">=</span> AES_Decrypt(data,p)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;./file.txt&#34;</span>,<span style="color:#e6db74">&#34;wb&#34;</span>) <span style="color:#66d9ef">as</span> new:
</span></span><span style="display:flex;"><span>        new<span style="color:#f92672">.</span>write(raw)
</span></span></code></pre></div><p>运行后得到解密文件，打开文件得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CTF{Im_Th@_B3S7_RicK_0f_Th3m_4ll}
</span></span></code></pre></div><p>两种解法都可以正常进行求解，求解得到flag。</p>
<p>用工具求解可能比较快，但是存在一定的局限性，需要对加密文件进行一定的处理</p>
<p>用脚本求解可能相对较慢，但是比较灵活可以灵活地处理文件，对解密脚本编写熟练的，可以尝试写脚本求解，速度也不慢</p>

      </div>
      <script>

        var liked_article = false

        if (typeof auth !== 'undefined') {
          var oid = "views_posts\\OtterCTF_2018_Memory_Forensic_writeup.md"
          var id = oid ? oid.replaceAll("/", "-") : oid

          var viewed = localStorage.getItem(id);

          if (!viewed) {
            auth.signInAnonymously()
              .then(() => {
                var docRef = db.collection('views').doc(id)
                localStorage.setItem(id, true);
                docRef.get().then((doc) => {
                  if (doc.exists) {
                    db.collection('views').doc(id).update({
                      views: firebase.firestore.FieldValue.increment(1)
                    });
                  } else {
                    db.collection('views').doc(id).set({ views: 1 })
                  }
                }).catch((error) => {
                  console.log("Error getting document:", error);
                });
              })
              .catch((error) => {
                var errorCode = error.code;
                var errorMessage = error.message;
                console.error(errorCode, errorMessage)
              });
          }

          var oid_likes = "likes_posts\\OtterCTF_2018_Memory_Forensic_writeup.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes

          var liked = localStorage.getItem(id_likes);

          if (liked) {
            liked_article = true
            document.querySelectorAll("button[id='likes_button']")[0].innerText = "Remove Like"
          }

        }

        function like_article(id_likes) {
          console.log("add")
          liked_article = true
          localStorage.setItem(id_likes, true);
          document.querySelectorAll("button[id='likes_button']")[0].innerText = "Remove Like"
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 1 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function remove_like_article(id_likes) {
          console.log("remove")
          liked_article = false
          localStorage.setItem(id_likes, false);
          document.querySelectorAll("button[id='likes_button']")[0].innerText = "Like"
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(-1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 0 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function process_article() {
          var oid_likes = "likes_posts\\OtterCTF_2018_Memory_Forensic_writeup.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes
          if (!liked_article) {
            like_article(id_likes)
          } else {
            remove_like_article(id_likes)
          }
        }
      </script>
  </section>
  <footer class="pt-8 max-w-prose print:hidden">
    
  <div class="flex">
    
      
      
        
        <img
          class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
          width="96"
          height="96"
          alt="OolongCode"
          src="/img/orca_hua93937f76bd5e462e54a483861805696_158669_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
          Author
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          OolongCode
        </div>
      
      
        <div class="text-sm text-neutral-700 dark:text-neutral-400">OolongCode and OrcasCode&rsquo;s CyberSpace!</div>
      
      <div class="text-2xl sm:text-lg">
</div>
    </div>
  </div>


    
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/&amp;title=OtterCTF%202018%20%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81%e5%a4%8d%e7%8e%b0"
          title="Share on LinkedIn"
          aria-label="Share on LinkedIn"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://twitter.com/intent/tweet/?url=https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/&amp;text=OtterCTF%202018%20%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81%e5%a4%8d%e7%8e%b0"
          title="Tweet on Twitter"
          aria-label="Tweet on Twitter"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</a
        >
      
    
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/&amp;description=OtterCTF%202018%20%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81%e5%a4%8d%e7%8e%b0"
          title="Pin on Pinterest"
          aria-label="Pin on Pinterest"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://reddit.com/submit/?url=https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/&amp;resubmit=true&amp;title=OtterCTF%202018%20%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81%e5%a4%8d%e7%8e%b0"
          title="Submit to Reddit"
          aria-label="Submit to Reddit"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.facebook.com/sharer/sharer.php?u=https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/&amp;quote=OtterCTF%202018%20%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81%e5%a4%8d%e7%8e%b0"
          title="Share on Facebook"
          aria-label="Share on Facebook"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="mailto:?body=https://www.codetea.top/posts/otterctf_2018_memory_forensic_writeup/&amp;subject=OtterCTF%202018%20%e5%86%85%e5%ad%98%e5%8f%96%e8%af%81%e5%a4%8d%e7%8e%b0"
          title="Send via email"
          aria-label="Send via email"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</a
        >
      
    
  </section>


    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/posts/xctf-reverse_daliy_002/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >攻防世界 RE 日常练习 002</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-09-04 11:30:27 &#43;0800 CST">September 4, 2022</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

        
          <div
            class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"
          >
            <a
              href="#the-top"
              class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
    <ul class="flex flex-col list-none sm:flex-row">
      
      <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/categories/"
          title="Categories">Categories</a>
      </li>
      
      <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/tags/"
          title="Tags">Tags</a>
      </li>
      
    </ul>
  </nav>
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2022
      OolongCode
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://nunocoracao.github.io/blowfish/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.1d5a3f4a9583d31668d777478074c0526be93b07cc79f303dce0ecc502226b04072b27e78185a927a25fd226da1de5a457c13cb89c85596512bd500006ee7602.js" integrity="sha512-HVo/SpWD0xZo13dHgHTAUmvpOwfMefMD3ODsxQIiawQHKyfngYWpJ6Jf0ibaHeWkV8E8uJyFWWUSvVAABu52Ag=="></script>
  
  
</footer><div
  id="search-wrapper"
  class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://www.codetea.top/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
