

<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>XCTF REVERSE novice_writeup &middot; OPdbg</title>
  <meta name="title" content="XCTF REVERSE novice_writeup &middot; OPdbg" />
  
  
  
  
  
  <link rel="canonical" href="https://www.codetea.top/posts/xctf-reverse-novice_writeup/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.69dfbd88ef7129902eaf1aee00660b4e9203142083f65f0194c832847f8b2a3782d909a54a812b51f6d40fbc4f9361ef007efd6259112be1875826f850711dd5.css"
    integrity="sha512-ad&#43;9iO9xKZAurxruAGYLTpIDFCCD9l8BlMgyhH&#43;LKjeC2QmlSoErUfbUD7xPk2HvAH79YlkRK&#43;GHWCb4UHEd1Q==" />
  
  
  <script type="text/javascript" src="/js/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js" integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP&#43;DGNKHfuwvY7kxvUdBeoGlODJ6&#43;SfaPg=="></script>
  
  
  <script type="text/javascript" src="/js/appearance.min.f94f4c4636d9e3ec8f5ee53cdc8ffa3d01bf87cd92ac85e6797550b1e2b80dc9118d838f3eb24c55109352455e72ff082dfe560283154e5a8f87fd75107b59c4.js"
    integrity="sha512-&#43;U9MRjbZ4&#43;yPXuU83I/6PQG/h82SrIXmeXVQseK4DckRjYOPPrJMVRCTUkVecv8ILf5WAoMVTlqPh/11EHtZxA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.3505add38a70acba51f9557ef4857df3e22668f612f62e52b3d5c4206205c5466595b8aeab4e238ac2225b9ff74bff24fee5b8d68940264e5bac7d35f1d7d7b5.js"
    integrity="sha512-NQWt04pwrLpR&#43;VV&#43;9IV98&#43;ImaPYS9i5Ss9XEIGIFxUZllbiuq04jisIiW5/3S/8k/uW41olAJk5brH018dfXtQ==" data-copy="" data-copied=""></script>
  
  <script src="/js/zoom.min.js"></script>
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="XCTF REVERSE novice_writeup" />
<meta property="og:description" content="XCTF-REVERSE-新手区 writeup # 来XCTF平台，做做Re练练手
XCTF平台有十道题目：
十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧
0x0 insanity # 往往第一道题目都不是很难，下载附件，看看是个什么东西。
文件没有扩展名，可能是个ELF文件，走个流程
首先查一下壳
果然是ELF格式的文件，不过不是x64格式的ELF文件
使用IDA pro打开文件，查看主函数的反编译代码
int __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax unsigned int v4; // eax puts(&#34;Reticulating splines, please wait..&#34;); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((&amp;strs)[v4 % 0xA]); return 0; } 跟进strs的数据
继续跟进strs的数据
get到了flag
9447{This_is_a_flag} 0x1 python-trade # 看题目应该是一个Python的逆向题目
文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译
可以使用 uncompyle 进行反编译：
# uncompyle6 version 3.7.4 # Python bytecode 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.codetea.top/posts/xctf-reverse-novice_writeup/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-14T13:27:13+08:00" />
<meta property="article:modified_time" content="2021-10-14T13:27:13+08:00" /><meta property="og:site_name" content="OPdbg" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="XCTF REVERSE novice_writeup"/>
<meta name="twitter:description" content="XCTF-REVERSE-新手区 writeup # 来XCTF平台，做做Re练练手
XCTF平台有十道题目：
十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧
0x0 insanity # 往往第一道题目都不是很难，下载附件，看看是个什么东西。
文件没有扩展名，可能是个ELF文件，走个流程
首先查一下壳
果然是ELF格式的文件，不过不是x64格式的ELF文件
使用IDA pro打开文件，查看主函数的反编译代码
int __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax unsigned int v4; // eax puts(&#34;Reticulating splines, please wait..&#34;); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((&amp;strs)[v4 % 0xA]); return 0; } 跟进strs的数据
继续跟进strs的数据
get到了flag
9447{This_is_a_flag} 0x1 python-trade # 看题目应该是一个Python的逆向题目
文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译
可以使用 uncompyle 进行反编译：
# uncompyle6 version 3.7.4 # Python bytecode 2."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "XCTF REVERSE novice_writeup",
    "headline": "XCTF REVERSE novice_writeup",
    
    "abstract": "XCTF-REVERSE-新手区 writeup # 来XCTF平台，做做Re练练手\nXCTF平台有十道题目：\n十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧\n0x0 insanity # 往往第一道题目都不是很难，下载附件，看看是个什么东西。\n文件没有扩展名，可能是个ELF文件，走个流程\n首先查一下壳\n果然是ELF格式的文件，不过不是x64格式的ELF文件\n使用IDA pro打开文件，查看主函数的反编译代码\nint __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; \/\/ eax unsigned int v4; \/\/ eax puts(\u0026#34;Reticulating splines, please wait..\u0026#34;); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((\u0026amp;strs)[v4 % 0xA]); return 0; } 跟进strs的数据\n继续跟进strs的数据\nget到了flag\n9447{This_is_a_flag} 0x1 python-trade # 看题目应该是一个Python的逆向题目\n文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译\n可以使用 uncompyle 进行反编译：\n# uncompyle6 version 3.7.4 # Python bytecode 2.",
    "inLanguage": "en",
    "url" : "https:\/\/www.codetea.top\/posts\/xctf-reverse-novice_writeup\/",
    "author" : {
      "@type": "Person",
      "name": "OolongCode"
    },
    "copyrightYear": "2021",
    "dateCreated": "2021-10-14T13:27:13\u002b08:00",
    "datePublished": "2021-10-14T13:27:13\u002b08:00",
    
    "dateModified": "2021-10-14T13:27:13\u002b08:00",
    
    "keywords": ["ctf","writeup","reverse"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2660"
  }]
  </script>


  
  
  <meta name="author" content="OolongCode" />
  
  
  






  
  
  
  


  
  
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  
  
  
</head><body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400"
          >&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <div style="padding-left:0;padding-right:0"
    class="flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">OPdbg</a>
            
            
        </nav>
        <div class="hidden md:flex items-center space-x-5 md:ml-12">

            
            
            <a href="/about/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="About">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


                 &nbsp; 
                About
            </a>
            
            <a href="/posts/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="Posts">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


                 &nbsp; 
                Posts
            </a>
            
            <a href="/link/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="Link">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>


                 &nbsp; 
                Link
            </a>
            
            <a href="https://github.com/OolongCode" class="text-base font-medium text-gray-500 hover:text-gray-900" title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                
                
            </a>
            
            

            


            
            <button id="search-button" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            
            <div
                class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
                <button id="appearance-switcher" type="button">
                    <div class="flex items-center justify-center h-12 dark:hidden">
                        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden h-12 dark:flex">
                        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </div>
        <div class="flex md:hidden items-center space-x-5 md:ml-12">

            <span></span>

            


            
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" type="button" style="margin-right:5px">
                <div class="flex items-center justify-center h-12 dark:hidden">
                    

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden h-12 dark:flex">
                    

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:25px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
                    <li class="mb-1">
                        <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/about/" title="About">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


                             &nbsp; 
                            About
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/posts/" title="Posts">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


                             &nbsp; 
                            Posts
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/link/" title="Link">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>


                             &nbsp; 
                            Link
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="https://github.com/OolongCode" title="">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                            
                            
                        </a>
                    </li>
                    
                    

                </ul>
            </div>
        </label>
    </div>
</div>


<div id="mobile-menu"
    class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
    <ul
        class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
        <li class="mb-1">
            <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
        </li>
        
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/about/" title="About">About</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/" title="Posts">Posts</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/link/" title="Link">Link</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="https://github.com/OolongCode" title=""></a>
        </li>
        
        
        
        <li>
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
        </li>
        
    </ul>
</div>
    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
<article>
  <header class="max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >OPdbg</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/xctf-reverse-novice_writeup/"
      >XCTF REVERSE novice_writeup</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      XCTF REVERSE novice_writeup
    </h1>
    <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      






































<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2021-10-14 13:27:13 &#43;0800 CST">October 14, 2021</time><span class="px-2 text-primary-500">&middot;</span><span>2660 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">13 mins</span><span class="px-2 text-primary-500">&middot;</span>


  
    
  
  

<span class="mb-[2px]">
  <a
    href="#/posts/XCTF-REVERSE-novice_writeup.md"
    class="text-lg hover:text-primary-500"
    rel="noopener noreferrer"
    target="_blank"
    title="Edit content"
    >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M490.3 40.4C512.2 62.27 512.2 97.73 490.3 119.6L460.3 149.7L362.3 51.72L392.4 21.66C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7L339.7 74.34L437.7 172.3L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2L159.6 382.8C150.1 385.6 141.5 383.4 135 376.1C128.6 370.5 126.4 361 129.2 352.4L158.8 263.6C161.6 255.3 166.2 247.8 172.4 241.7V241.7zM192 63.1C209.7 63.1 224 78.33 224 95.1C224 113.7 209.7 127.1 192 127.1H96C78.33 127.1 64 142.3 64 159.1V416C64 433.7 78.33 448 96 448H352C369.7 448 384 433.7 384 416V319.1C384 302.3 398.3 287.1 416 287.1C433.7 287.1 448 302.3 448 319.1V416C448 469 405 512 352 512H96C42.98 512 0 469 0 416V159.1C0 106.1 42.98 63.1 96 63.1H192z"/></svg>

  </span>

</a
  >
</span>
  

  
  



</div>






    </div>
  </header>
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
     <div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">
        <details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#0x0-insanity">0x0 insanity</a></li>
    <li><a href="#0x1-python-trade">0x1 python-trade</a></li>
    <li><a href="#0x2-re1">0x2 re1</a></li>
    <li><a href="#0x3-game">0x3 game</a></li>
    <li><a href="#0x4-hello-ctf">0x4 Hello, CTF</a></li>
    <li><a href="#0x5-open-source">0x5 open-source</a></li>
    <li><a href="#0x6-simple-unpack">0x6 simple-unpack</a></li>
    <li><a href="#0x7-logmein">0x7 logmein</a></li>
    <li><a href="#0x8-no-string-attached">0x8 no-string-attached</a></li>
    <li><a href="#0x9-getit">0x9 getit</a></li>
    <li><a href="#0xa-csaw2013reversing2">0xA csaw2013reversing2</a></li>
    <li><a href="#0xb-maze">0xB maze</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#0x0-insanity">0x0 insanity</a></li>
    <li><a href="#0x1-python-trade">0x1 python-trade</a></li>
    <li><a href="#0x2-re1">0x2 re1</a></li>
    <li><a href="#0x3-game">0x3 game</a></li>
    <li><a href="#0x4-hello-ctf">0x4 Hello, CTF</a></li>
    <li><a href="#0x5-open-source">0x5 open-source</a></li>
    <li><a href="#0x6-simple-unpack">0x6 simple-unpack</a></li>
    <li><a href="#0x7-logmein">0x7 logmein</a></li>
    <li><a href="#0x8-no-string-attached">0x8 no-string-attached</a></li>
    <li><a href="#0x9-getit">0x9 getit</a></li>
    <li><a href="#0xa-csaw2013reversing2">0xA csaw2013reversing2</a></li>
    <li><a href="#0xb-maze">0xB maze</a></li>
  </ul>
</nav>
  </div>
</details>

      </div>
      </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <h1 id="xctf-reverse-新手区-writeup" class="relative group">XCTF-REVERSE-新手区 writeup <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#xctf-reverse-%e6%96%b0%e6%89%8b%e5%8c%ba-writeup" aria-label="Anchor">#</a></span></h1>
<p>来XCTF平台，做做Re练练手</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902134256690.png" alt="image-20210902134256690" />
      
    </figure>
  

</p>
<p>XCTF平台有十道题目：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902134352010.png" alt="image-20210902134352010" />
      
    </figure>
  

</p>
<p>十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧</p>
<h2 id="0x0-insanity" class="relative group">0x0 insanity <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x0-insanity" aria-label="Anchor">#</a></span></h2>
<p>往往第一道题目都不是很难，下载附件，看看是个什么东西。</p>
<p>文件没有扩展名，可能是个ELF文件，走个流程</p>
<p>首先查一下壳</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902135713948.png" alt="image-20210902135713948" />
      
    </figure>
  

</p>
<p>果然是ELF格式的文件，不过不是x64格式的ELF文件</p>
<p>使用IDA pro打开文件，查看主函数的反编译代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v4; <span style="color:#75715e">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  puts(<span style="color:#e6db74">&#34;Reticulating splines, please wait..&#34;</span>);
</span></span><span style="display:flex;"><span>  sleep(<span style="color:#ae81ff">5u</span>);
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> time(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  srand(v3);
</span></span><span style="display:flex;"><span>  v4 <span style="color:#f92672">=</span> rand();
</span></span><span style="display:flex;"><span>  puts((<span style="color:#f92672">&amp;</span>strs)[v4 <span style="color:#f92672">%</span> <span style="color:#ae81ff">0xA</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>跟进strs的数据</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902145813017.png" alt="image-20210902145813017" />
      
    </figure>
  

</p>
<p>继续跟进strs的数据</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902145852653.png" alt="image-20210902145852653" />
      
    </figure>
  

</p>
<p>get到了flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>9447{This_is_a_flag}
</span></span></code></pre></div><h2 id="0x1-python-trade" class="relative group">0x1 python-trade <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x1-python-trade" aria-label="Anchor">#</a></span></h2>
<p>看题目应该是一个Python的逆向题目</p>
<p>文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译</p>
<p>可以使用 <code>uncompyle</code> 进行反编译：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># uncompyle6 version 3.7.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Python bytecode 2.7 (62211)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Embedded file name: 1.py</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compiled at: 2017-06-03 10:20:43</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encode</span>(message):
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> message:
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> ord(i) <span style="color:#f92672">^</span> <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> x <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">+=</span> chr(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> base64<span style="color:#f92672">.</span>b64encode(s)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>correct <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&#39;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;Input flag:&#39;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> raw_input()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> encode(flag) <span style="color:#f92672">==</span> correct:
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#39;correct&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#39;wrong&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># okay decompiling .\test.pyc</span>
</span></span></code></pre></div><p>应该是需要逆这个加密算法的进行求解，密码手的老本行了，写个求解脚本:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Redecode</span>(cipher):
</span></span><span style="display:flex;"><span>    message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    cipher <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b64decode(cipher)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> cipher:
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> ord(i) <span style="color:#f92672">-</span> <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> x <span style="color:#f92672">^</span> <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>        message <span style="color:#f92672">+=</span> chr(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> message
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> Redecode(cipher)
</span></span><span style="display:flex;"><span>print(flag)
</span></span></code></pre></div><p>在python2环境下运行脚本，就能得到flag了：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>nctf{d3c0mpil1n9_PyC}
</span></span></code></pre></div><h2 id="0x2-re1" class="relative group">0x2 re1 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x2-re1" aria-label="Anchor">#</a></span></h2>
<p>附件有报毒，麻了</p>
<p>走一下流程，先查文件信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902152537015.png" alt="image-20210902152537015" />
      
    </figure>
  

</p>
<p>32位的可执行程序，程序没有壳，丢进IDA pro进行静态分析</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__m128i</span> v5; <span style="color:#75715e">// [esp+0h] [ebp-44h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v6[<span style="color:#ae81ff">8</span>]; <span style="color:#75715e">// [esp+10h] [ebp-34h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// [esp+18h] [ebp-2Ch]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int16</span> v8; <span style="color:#75715e">// [esp+1Ch] [ebp-28h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v9[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [esp+20h] [ebp-24h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  v5 <span style="color:#f92672">=</span> _mm_loadu_si128((<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">__m128i</span> <span style="color:#f92672">*</span>)<span style="color:#e6db74">&#34;DUTCTF{We1c0met0DUTCTF}&#34;</span>);
</span></span><span style="display:flex;"><span>  v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  strcpy(v6, <span style="color:#e6db74">&#34;DUTCTF}&#34;</span>);
</span></span><span style="display:flex;"><span>  v8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  printf(<span style="color:#e6db74">&#34;欢迎来到DUTCTF呦</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  printf(<span style="color:#e6db74">&#34;这是一道很可爱很简单的逆向题呦</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  printf(<span style="color:#e6db74">&#34;输入flag吧:&#34;</span>);
</span></span><span style="display:flex;"><span>  scanf(<span style="color:#e6db74">&#34;%s&#34;</span>, v9);
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> strcmp(v5.m128i_i8, v9);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( v3 )
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> v3 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">?</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( v3 )
</span></span><span style="display:flex;"><span>    printf(aFlag_0);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    printf(aFlagGet);
</span></span><span style="display:flex;"><span>  system(<span style="color:#e6db74">&#34;pause&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>首先，我们需要知道具体的逻辑判断形式，逻辑判断是以什么形式进行判断的，找到逻辑判断语句</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( v3 )
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> v3 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">?</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( v3 )
</span></span><span style="display:flex;"><span>    printf(aFlag_0);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(aFlagGet);
</span></span></code></pre></div><p><code>v3</code> 数值不为0的情况下会先执行第一个 <code>if</code> 语句，将不正确的v3值进行转换</p>
<p>然后再进行一个<code>if - else </code> 的逻辑语句，判断<code>v3</code>的数值，如果<code>v3</code>的数值是等于<code>0</code>的，那么我们输入的flag就是正确的</p>
<p>那么，<code>v3</code> 是什么东西？</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>v3 <span style="color:#f92672">=</span> strcmp(v5.m128i_i8, v9);
</span></span></code></pre></div><p>是一个比较数值，如果 <code>v5.m128i_i8</code> 与 <code>v9</code> 相等，那么<code>v3</code> 的数值就等于0了，逻辑现在搞通了，下面跟进数据：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902155119211.png" alt="image-20210902155119211" />
      
    </figure>
  

</p>
<p>这段数据应该就是 <code>v5 </code>的数据了，将数据转换成字符串</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902155219566.png" alt="image-20210902155219566" />
      
    </figure>
  

</p>
<p>成功得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>DUTCTF{We1c0met0DUTCTF}
</span></span></code></pre></div><h2 id="0x3-game" class="relative group">0x3 game <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x3-game" aria-label="Anchor">#</a></span></h2>
<p>应该是个游戏，感觉还是挺有意思的</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902160124008.png" alt="image-20210902160124008" />
      
    </figure>
  

</p>
<p>果然是一个游戏，还蛮有意思的，不过，还是要走下流程查一下信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210902160325396.png" alt="image-20210902160325396" />
      
    </figure>
  

</p>
<p>32位程序，没有壳，先丢进IDA pro康一康</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main_0</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [esp+DCh] [ebp-20h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v5; <span style="color:#75715e">// [esp+F4h] [ebp-8h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B110);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B158);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B1A0);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B1E8);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B230);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B278);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B2C0);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#f92672">&amp;</span>unk_50B308);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#e6db74">&#34;二                                                     |</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#e6db74">&#34;|              by 0x61                                 |</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#e6db74">&#34;|                                                      |</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#e6db74">&#34;|------------------------------------------------------|</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Play a game</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;The n is the serial number of the lamp,and m is the state of the lamp</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;If m of the Nth lamp is 1,it&#39;s on ,if not it&#39;s off</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;At first all the lights were closed</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#e6db74">&#34;Now you can input n to change its state</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;But you should pay attention to one thing,if you change the state of the Nth lamp,the state of (N-1)th and (N+1)th w&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ill be changed too</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#e6db74">&#34;When all lamps are on,flag will appear</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_45A7BE(<span style="color:#e6db74">&#34;Now,input n </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> ( <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> ( <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      sub_45A7BE(<span style="color:#e6db74">&#34;input n,n(1-8)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>      sub_459418();
</span></span><span style="display:flex;"><span>      sub_45A7BE(<span style="color:#e6db74">&#34;n=&#34;</span>);
</span></span><span style="display:flex;"><span>      sub_4596D4(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>v5);
</span></span><span style="display:flex;"><span>      sub_45A7BE(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( v5 <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> v5 <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">8</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      sub_45A7BE(<span style="color:#e6db74">&#34;sorry,n error,try again</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( v5 )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      sub_4576D6(v5 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)i <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">9</span> )
</span></span><span style="display:flex;"><span>          sub_458919();
</span></span><span style="display:flex;"><span>        byte_532E28[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    sub_4581B7(<span style="color:#e6db74">&#34;CLS&#34;</span>);
</span></span><span style="display:flex;"><span>    sub_458054();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( byte_532E28[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      sub_457AB4();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>寻找到核心代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( byte_532E28[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&amp;&amp;</span> byte_532E28[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      sub_457AB4();
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>可以知道，可以确定是 <code>sub_457AB4();</code> 函数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sub_45E940</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> v1; <span style="color:#75715e">// [esp+0h] [ebp-164h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [esp+D0h] [ebp-94h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v3[<span style="color:#ae81ff">22</span>]; <span style="color:#75715e">// [esp+DCh] [ebp-88h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v4[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [esp+F2h] [ebp-72h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v5[<span style="color:#ae81ff">4</span>]; <span style="color:#75715e">// [esp+112h] [ebp-52h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v6[<span style="color:#ae81ff">64</span>]; <span style="color:#75715e">// [esp+120h] [ebp-44h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  sub_45A7BE((<span style="color:#66d9ef">int</span>)<span style="color:#e6db74">&#34;done!!! the flag is &#34;</span>, v1);
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">98</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">48</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">49</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">48</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">31</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">78</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">62</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">49</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">57</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">96</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">62</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">34</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">35</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">36</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">44</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">37</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">38</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">78</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">39</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">40</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">41</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">97</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">42</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">54</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">43</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">44</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">44</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">45</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">52</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">46</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">47</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">89</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">49</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">45</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">50</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">51</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">52</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">53</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">34</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">54</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">55</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>;
</span></span><span style="display:flex;"><span>  v6[<span style="color:#ae81ff">56</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">123</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">98</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">119</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">108</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">41</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">124</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">80</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">125</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">38</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">124</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">111</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">74</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">49</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">83</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">108</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">94</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">108</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">84</span>;
</span></span><span style="display:flex;"><span>  v3[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>;
</span></span><span style="display:flex;"><span>  qmemcpy(v4, <span style="color:#e6db74">&#34;`S,yhn _uec{&#34;</span>, <span style="color:#ae81ff">12</span>);
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">127</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">119</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">96</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">48</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">107</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">71</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">92</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">29</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">81</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">107</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">90</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">85</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">76</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">86</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">114</span>;
</span></span><span style="display:flex;"><span>  v4[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  strcpy(v5, <span style="color:#e6db74">&#34;u~&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">56</span>; <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    v3[i] <span style="color:#f92672">^=</span> v6[i];
</span></span><span style="display:flex;"><span>    v3[i] <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x13u</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> sub_45A7BE((<span style="color:#66d9ef">int</span>)<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, (<span style="color:#66d9ef">char</span>)v3);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>基本上可以确定在这里输出flag，基本逻辑应该可以清晰的知道</p>
<p>下面使用Ollydbg进行动态调试，调试出来flag</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210909174908510.png" alt="image-20210909174908510" />
      
    </figure>
  

</p>
<p>先使用F8进行单步调试，确定关键函数位置</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210909195648745.png" alt="image-20210909195648745" />
      
    </figure>
  

</p>
<p>F7进入函数的具体执行过程，进行字符串检索</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210909195755383.png" alt="image-20210909195755383" />
      
    </figure>
  

</p>
<p>找到输入的关键位置，然后移动到关键位置</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210909195839072.png" alt="image-20210909195839072" />
      
    </figure>
  

</p>
<p>根据已知的逻辑循环，修改逻辑循环</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210909200656065.png" alt="image-20210909200656065" />
      
    </figure>
  

</p>
<p>修改这个关键性的跳转代码进行跳转修改，将跳转修改为call那个位置</p>
<p>修改为：</p>
<pre tabindex="0"><code class="language-x86asm" data-lang="x86asm">jnz short 00D2F66C
</code></pre><p>然后运行修改过汇编的程序</p>
<p>尝试输入几个参数就能获取到flag了</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210909201014405.png" alt="image-20210909201014405" />
      
    </figure>
  

</p>
<p>得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>zsctf{T9is_tOpic_1s_v5ry_int7resting_b6t_others_are_n0t}
</span></span></code></pre></div><h2 id="0x4-hello-ctf" class="relative group">0x4 Hello, CTF <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x4-hello-ctf" aria-label="Anchor">#</a></span></h2>
<p>首先查一下程序信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210909201418156.png" alt="image-20210909201418156" />
      
    </figure>
  

</p>
<p>32位没有壳的程序</p>
<p>使用IDA pro的看一下程序</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// ebx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v4; <span style="color:#75715e">// al
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> result; <span style="color:#75715e">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v6; <span style="color:#75715e">// [esp+0h] [ebp-70h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// [esp+0h] [ebp-70h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> Buffer[<span style="color:#ae81ff">2</span>]; <span style="color:#75715e">// [esp+12h] [ebp-5Eh] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v9[<span style="color:#ae81ff">20</span>]; <span style="color:#75715e">// [esp+14h] [ebp-5Ch] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v10[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [esp+28h] [ebp-48h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int16</span> v11; <span style="color:#75715e">// [esp+48h] [ebp-28h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v12; <span style="color:#75715e">// [esp+4Ah] [ebp-26h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v13[<span style="color:#ae81ff">36</span>]; <span style="color:#75715e">// [esp+4Ch] [ebp-24h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  strcpy(v13, <span style="color:#e6db74">&#34;437261636b4d654a757374466f7246756e&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> ( <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    memset(v10, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(v10));
</span></span><span style="display:flex;"><span>    v11 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    v12 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    sub_40134B(aPleaseInputYou, v6);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;%s&#34;</span>, v9);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( strlen(v9) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0x11</span> )
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">17</span>; <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v4 <span style="color:#f92672">=</span> v9[i];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>v4 )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>      sprintf(Buffer, <span style="color:#e6db74">&#34;%x&#34;</span>, v4);
</span></span><span style="display:flex;"><span>      strcat(v10, Buffer);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>strcmp(v10, v13) )
</span></span><span style="display:flex;"><span>      sub_40134B(aSuccess, v7);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      sub_40134B(aWrong, v7);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  sub_40134B(aWrong, v7);
</span></span><span style="display:flex;"><span>  result <span style="color:#f92672">=</span> <span style="color:#f92672">--</span>Stream._cnt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( Stream._cnt <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> _filbuf(<span style="color:#f92672">&amp;</span>Stream);
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">++</span>Stream._ptr;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>代码非常清晰，应该可以明确v13的值和flag应该是一致的</p>
<p>v13应该是Hex编码的字符串，进行解码就得到flag了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>CrackMeJustForFun
</span></span></code></pre></div><h2 id="0x5-open-source" class="relative group">0x5 open-source <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x5-open-source" aria-label="Anchor">#</a></span></h2>
<p>下载附件，源代码审计，看看源代码内容</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>argv[]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (argc <span style="color:#f92672">!=</span> <span style="color:#ae81ff">4</span>) {
</span></span><span style="display:flex;"><span>    	printf(<span style="color:#e6db74">&#34;what?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	exit(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> first <span style="color:#f92672">=</span> atoi(argv[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (first <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0xcafe</span>) {
</span></span><span style="display:flex;"><span>    	printf(<span style="color:#e6db74">&#34;you are wrong, sorry.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	exit(<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> second <span style="color:#f92672">=</span> atoi(argv[<span style="color:#ae81ff">2</span>]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (second <span style="color:#f92672">%</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">||</span> second <span style="color:#f92672">%</span> <span style="color:#ae81ff">17</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">8</span>) {
</span></span><span style="display:flex;"><span>    	printf(<span style="color:#e6db74">&#34;ha, you won&#39;t get it!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	exit(<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (strcmp(<span style="color:#e6db74">&#34;h4cky0u&#34;</span>, argv[<span style="color:#ae81ff">3</span>])) {
</span></span><span style="display:flex;"><span>    	printf(<span style="color:#e6db74">&#34;so close, dude!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    	exit(<span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Brr wrrr grr</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> hash <span style="color:#f92672">=</span> first <span style="color:#f92672">*</span> <span style="color:#ae81ff">31337</span> <span style="color:#f92672">+</span> (second <span style="color:#f92672">%</span> <span style="color:#ae81ff">17</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">11</span> <span style="color:#f92672">+</span> strlen(argv[<span style="color:#ae81ff">3</span>]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1615810207</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Get your key: &#34;</span>);
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, hash);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>根据源码进行求解，其实也就是解个方程</p>
<p>可以写个C程序直接求解</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> first <span style="color:#f92672">=</span>  <span style="color:#ae81ff">0xcafe</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> second <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> Third <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;h4cky0u&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> hash <span style="color:#f92672">=</span> first <span style="color:#f92672">*</span> <span style="color:#ae81ff">31337</span> <span style="color:#f92672">+</span> (second <span style="color:#f92672">%</span> <span style="color:#ae81ff">17</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">11</span> <span style="color:#f92672">+</span> strlen(Third) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1615810207</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Get your key: &#34;</span>);
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, hash);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>编译并运行程序就能得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Get your key: c0ffee
</span></span></code></pre></div><h2 id="0x6-simple-unpack" class="relative group">0x6 simple-unpack <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x6-simple-unpack" aria-label="Anchor">#</a></span></h2>
<p>看题目，应该是一个有壳的程序</p>
<p>就正常走一下流程首先先要看看程序的信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210910132745520.png" alt="image-20210910132745520" />
      
    </figure>
  

</p>
<p>加壳的64位的程序，首先使用upx脱一下壳，然后使用x64 IDA pro查看</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210910133500403.png" alt="image-20210910133500403" />
      
    </figure>
  

</p>
<p>直接就能看到flag信息数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>flag{Upx_1s_n0t_a_d3liv3r_c0mp4ny}
</span></span></code></pre></div><h2 id="0x7-logmein" class="relative group">0x7 logmein <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x7-logmein" aria-label="Anchor">#</a></span></h2>
<p>查一下程序信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210910133947331.png" alt="image-20210910133947331" />
      
    </figure>
  

</p>
<p>没有壳，64位的Linux程序</p>
<p>直接进行x64 ida pro静态调试</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#66d9ef">__fastcall</span> __noreturn <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> a1, <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>a2, <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>a3)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  size_t v3; <span style="color:#75715e">// rsi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [rsp+3Ch] [rbp-54h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> s[<span style="color:#ae81ff">36</span>]; <span style="color:#75715e">// [rsp+40h] [rbp-50h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v6; <span style="color:#75715e">// [rsp+64h] [rbp-2Ch]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v7; <span style="color:#75715e">// [rsp+68h] [rbp-28h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v8[<span style="color:#ae81ff">28</span>]; <span style="color:#75715e">// [rsp+70h] [rbp-20h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v9; <span style="color:#75715e">// [rsp+8Ch] [rbp-4h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  v9 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  strcpy(v8, <span style="color:#e6db74">&#34;:</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">AL_RT^L*.?+6/46&#34;</span>);
</span></span><span style="display:flex;"><span>  v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x65626D61726168LL</span>;
</span></span><span style="display:flex;"><span>  v6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">7</span>;
</span></span><span style="display:flex;"><span>  printf(<span style="color:#e6db74">&#34;Welcome to the RC3 secure password guesser.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  printf(<span style="color:#e6db74">&#34;To continue, you must enter the correct password.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>  printf(<span style="color:#e6db74">&#34;Enter your guess: &#34;</span>);
</span></span><span style="display:flex;"><span>  __isoc99_scanf(<span style="color:#e6db74">&#34;%32s&#34;</span>, s);
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> strlen(s);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( v3 <span style="color:#f92672">&lt;</span> strlen(v8) )
</span></span><span style="display:flex;"><span>    sub_4007C0();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> strlen(s); <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( i <span style="color:#f92672">&gt;=</span> strlen(v8) )
</span></span><span style="display:flex;"><span>      sub_4007C0();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( s[i] <span style="color:#f92672">!=</span> (<span style="color:#66d9ef">char</span>)(<span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v7 <span style="color:#f92672">+</span> i <span style="color:#f92672">%</span> v6) <span style="color:#f92672">^</span> v8[i]) )
</span></span><span style="display:flex;"><span>      sub_4007C0();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  sub_4007F0();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>应该是对算法进行逆向来得到相应的flag</p>
<p>关键的数据是v7和v8，针对这两个数据写个C程序进行逆向算法</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> v8[<span style="color:#ae81ff">28</span>];
</span></span><span style="display:flex;"><span>        strcpy(v8, <span style="color:#e6db74">&#34;:</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">AL_RT^L*.?+6/46&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>v7 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;harambe&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> v6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">7</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> s[strlen(v8)];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> strlen(v8); <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>                s[i] <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(v7<span style="color:#f92672">+</span>i <span style="color:#f92672">%</span> v6) <span style="color:#f92672">^</span> v8[i];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,s);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>编译并运行得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>RC3-2016-XORISGUD
</span></span></code></pre></div><h2 id="0x8-no-string-attached" class="relative group">0x8 no-string-attached <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x8-no-string-attached" aria-label="Anchor">#</a></span></h2>
<p>查一下文件的信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210910153107869.png" alt="image-20210910153107869" />
      
    </figure>
  

</p>
<p>32位文件，没有壳，丢进到IDA pro查看</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  setlocale(<span style="color:#ae81ff">6</span>, <span style="color:#f92672">&amp;</span>locale);
</span></span><span style="display:flex;"><span>  banner();
</span></span><span style="display:flex;"><span>  prompt_authentication();
</span></span><span style="display:flex;"><span>  authenticate();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>进行分析，确定flag应该是在 <code>authenticate()</code>函数中</p>
<p>跟进到 <code>authenticate()</code>函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">authenticate</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  wchar_t ws[<span style="color:#ae81ff">8192</span>]; <span style="color:#75715e">// [esp+1Ch] [ebp-800Ch] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  wchar_t <span style="color:#f92672">*</span>s2; <span style="color:#75715e">// [esp+801Ch] [ebp-Ch]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  s2 <span style="color:#f92672">=</span> (wchar_t <span style="color:#f92672">*</span>)decrypt((wchar_t <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>s, (wchar_t <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>dword_8048A90);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( fgetws(ws, <span style="color:#ae81ff">0x2000</span>, stdin) )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    ws[wcslen(ws) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>wcscmp(ws, s2) )
</span></span><span style="display:flex;"><span>      wprintf(<span style="color:#f92672">&amp;</span>unk_8048B44);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      wprintf(<span style="color:#f92672">&amp;</span>unk_8048BA4);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  free(s2);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>关键数据应该是在s2中，调用了decrypt函数，看一下这个函数的汇编代码</p>
<pre tabindex="0"><code class="language-x86asm" data-lang="x86asm">ws= dword ptr -800Ch
s2= dword ptr -0Ch

; __unwind {
push    ebp
mov     ebp, esp
sub     esp, 8028h
mov     dword ptr [esp+4], offset dword_8048A90 ; wchar_t *
mov     dword ptr [esp], offset s ; s
call    decrypt
mov     [ebp+s2], eax
mov     eax, ds:stdin@@GLIBC_2_0
mov     [esp+8], eax    ; stream
mov     dword ptr [esp+4], 2000h ; n
lea     eax, [ebp+ws]
mov     [esp], eax      ; ws
call    _fgetws
test    eax, eax
jz      short loc_804879C
</code></pre><p>根据汇编代码，应该可以清晰的知道，flag数据应该是存储在eax寄存器中了</p>
<p>使用gdb动态调试程序</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb Re_demo
</span></span></code></pre></div><p>然后设置断点，根据刚刚了解到的信息，flag的数据应该是在decrypt函数中，设置断点</p>
<pre tabindex="0"><code class="language-gdb" data-lang="gdb">b decrypt
</code></pre><p>然后运行程序到断点</p>
<pre tabindex="0"><code class="language-gdb" data-lang="gdb">r
</code></pre><p>然后单步执行</p>
<pre tabindex="0"><code class="language-gdb" data-lang="gdb">n
</code></pre><p>查看寄存器</p>
<pre tabindex="0"><code class="language-gdb" data-lang="gdb">i r
</code></pre><p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210910155818798.png" alt="image-20210910155818798" />
      
    </figure>
  

</p>
<p>然后查看eax寄存器存储的数据</p>
<pre tabindex="0"><code class="language-gdb" data-lang="gdb">x/sw $eax
</code></pre><p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210910155914675.png" alt="image-20210910155914675" />
      
    </figure>
  

</p>
<p>成功拿到flag数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>9447{you_are_an_international_mystery}
</span></span></code></pre></div><h2 id="0x9-getit" class="relative group">0x9 getit <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0x9-getit" aria-label="Anchor">#</a></span></h2>
<p>基本流程，查看程序信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210910160228522.png" alt="image-20210910160228522" />
      
    </figure>
  

</p>
<p>64位无壳的ELF可执行程序</p>
<p>先丢进x64 IDA pro看一看</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> v3; <span style="color:#75715e">// al
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [rsp+0h] [rbp-40h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> j; <span style="color:#75715e">// [rsp+4h] [rbp-3Ch]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  FILE <span style="color:#f92672">*</span>stream; <span style="color:#75715e">// [rsp+8h] [rbp-38h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> filename[<span style="color:#ae81ff">24</span>]; <span style="color:#75715e">// [rsp+10h] [rbp-30h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> v9; <span style="color:#75715e">// [rsp+28h] [rbp-18h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  v9 <span style="color:#f92672">=</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> strlen(s); <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( (i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> )
</span></span><span style="display:flex;"><span>      v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      v3 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(<span style="color:#f92672">&amp;</span>t <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span>) <span style="color:#f92672">=</span> s[i] <span style="color:#f92672">+</span> v3;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  strcpy(filename, <span style="color:#e6db74">&#34;/tmp/flag.txt&#34;</span>);
</span></span><span style="display:flex;"><span>  stream <span style="color:#f92672">=</span> fopen(filename, <span style="color:#e6db74">&#34;w&#34;</span>);
</span></span><span style="display:flex;"><span>  fprintf(stream, <span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, u);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> strlen(<span style="color:#f92672">&amp;</span>t); <span style="color:#f92672">++</span>j )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    fseek(stream, p[j], <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    fputc(<span style="color:#f92672">*</span>(<span style="color:#f92672">&amp;</span>t <span style="color:#f92672">+</span> p[j]), stream);
</span></span><span style="display:flex;"><span>    fseek(stream, <span style="color:#ae81ff">0LL</span>, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    fprintf(stream, <span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, u);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  fclose(stream);
</span></span><span style="display:flex;"><span>  remove(filename);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>应该是一个文件写入的程序，打开一个文件并进行写入</p>
<p>对程序进行分析应该可以看出三个部分</p>
<ol>
<li>初始化变量</li>
<li>生成flag数据</li>
<li>写入flag数据</li>
</ol>
<p>查看一下静态数据：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210911072552068.png" alt="image-20210911072552068" />
      
    </figure>
  

</p>
<p>根据静态数据和对代码分析的结果，写一个flag生成器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> t[] <span style="color:#f92672">=</span><span style="color:#e6db74">&#34; harifCTF{????????????????????????????????}&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> s[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c61b68366edeb7bdce3c6820314b7498&#34;</span>;
</span></span><span style="display:flex;"><span>        t[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x53</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i, v3;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> strlen(s); <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> ( (i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> )
</span></span><span style="display:flex;"><span>                        v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>                        v3 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">*</span>(t<span style="color:#f92672">+</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>) <span style="color:#f92672">=</span> s[i]<span style="color:#f92672">+</span>v3;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,t);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>编译并运行flag生成器就可以生成flag啦！</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>SharifCTF{b70c59275fcfa8aebf2d5911223c6589}
</span></span></code></pre></div><h2 id="0xa-csaw2013reversing2" class="relative group">0xA csaw2013reversing2 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0xa-csaw2013reversing2" aria-label="Anchor">#</a></span></h2>
<p>杀软会报毒的程序，首先查一下壳</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210911082611406.png" alt="image-20210911082611406" />
      
    </figure>
  

</p>
<p>32位无壳程序，使用IDA pro查看详细信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> __noreturn <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// ecx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  CHAR <span style="color:#f92672">*</span>lpMem; <span style="color:#75715e">// [esp+8h] [ebp-Ch]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  HANDLE hHeap; <span style="color:#75715e">// [esp+10h] [ebp-4h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  hHeap <span style="color:#f92672">=</span> HeapCreate(<span style="color:#ae81ff">0x40000u</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  lpMem <span style="color:#f92672">=</span> (CHAR <span style="color:#f92672">*</span>)HeapAlloc(hHeap, <span style="color:#ae81ff">8u</span>, SourceSize <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  memcpy_s(lpMem, SourceSize, <span style="color:#f92672">&amp;</span>unk_409B10, SourceSize);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>sub_40102A() <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>IsDebuggerPresent() )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    MessageBoxA(<span style="color:#ae81ff">0</span>, lpMem <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;Flag&#34;</span>, <span style="color:#ae81ff">2u</span>);
</span></span><span style="display:flex;"><span>    HeapFree(hHeap, <span style="color:#ae81ff">0</span>, lpMem);
</span></span><span style="display:flex;"><span>    HeapDestroy(hHeap);
</span></span><span style="display:flex;"><span>    ExitProcess(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  __debugbreak();
</span></span><span style="display:flex;"><span>  sub_401000(v3 <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>, lpMem);
</span></span><span style="display:flex;"><span>  ExitProcess(<span style="color:#ae81ff">0xFFFFFFFF</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>都是WIN32api的调用，尝试运行一下程序：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210911084558336.png" alt="image-20210911084558336" />
      
    </figure>
  

</p>
<p>应该是有些关键的语句没有执行</p>
<p>可以查看下IDA pro的汇编语句</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210913082559422.png" alt="image-20210913082559422" />
      
    </figure>
  

</p>
<p>显然是有一个Flag没有进行相应的跳转，显然有着较大的嫌疑，可以尝试去搞一搞让其跳转</p>
<p>使用OD进行调试修改汇编让其进行跳转，首先定位到Flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>000D1092   .  85C0          test    eax, eax
</span></span><span style="display:flex;"><span>000D1094      74 23         je      short 000D10B9
</span></span><span style="display:flex;"><span>000D1096   &gt;  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1097   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1098   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1099   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D109A      CC            int3
</span></span><span style="display:flex;"><span>000D109B   .  8B55 F4       mov     edx, dword ptr [ebp-C]
</span></span><span style="display:flex;"><span>000D109E   .  E8 5DFFFFFF   call    000D1000
</span></span><span style="display:flex;"><span>000D10A3      EB 4A         jmp     short 000D10EF
</span></span><span style="display:flex;"><span>000D10A5   .  6A 02         push    2                                ; /Style = MB_ABORTRETRYIGNORE|MB_APPLMODAL
</span></span><span style="display:flex;"><span>000D10A7   .  68 20780D00   push    000D7820                         ; |Title = &#34;Flag&#34;
</span></span><span style="display:flex;"><span>000D10AC   .  FF75 F4       push    dword ptr [ebp-C]                ; |Text
</span></span><span style="display:flex;"><span>000D10AF   .  6A 00         push    0                                ; |hOwner = NULL
</span></span><span style="display:flex;"><span>000D10B1   .  FF15 E4600D00 call    dword ptr [&lt;&amp;USER32.MessageBoxA&gt;&gt;; \MessageBoxA
</span></span><span style="display:flex;"><span>000D10B7   .  EB 14         jmp     short 000D10CD
</span></span><span style="display:flex;"><span>000D10B9   &gt;  6A 02         push    2                                ; /Style = MB_ABORTRETRYIGNORE|MB_APPLMODAL
</span></span><span style="display:flex;"><span>000D10BB   .  68 20780D00   push    000D7820                         ; |Title = &#34;Flag&#34;
</span></span><span style="display:flex;"><span>000D10C0   .  8B45 F4       mov     eax, dword ptr [ebp-C]           ; |
</span></span><span style="display:flex;"><span>000D10C3   .  40            inc     eax                              ; |
</span></span><span style="display:flex;"><span>000D10C4   .  50            push    eax                              ; |Text
</span></span><span style="display:flex;"><span>000D10C5   .  6A 00         push    0                                ; |hOwner = NULL
</span></span><span style="display:flex;"><span>000D10C7   .  FF15 E4600D00 call    dword ptr [&lt;&amp;USER32.MessageBoxA&gt;&gt;; \MessageBoxA
</span></span></code></pre></div><p>然后定位到if语句对应的汇编语句</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>000D1083   .  E8 A2FFFFFF   call    000D102A
</span></span><span style="display:flex;"><span>000D1088   .  85C0          test    eax, eax
</span></span><span style="display:flex;"><span>000D108A   .  75 0A         jnz     short 000D1096
</span></span><span style="display:flex;"><span>000D108C   .  FF15 14600D00 call    dword ptr [&lt;&amp;KERNEL32.IsDebugger&gt;; [IsDebuggerPresent
</span></span><span style="display:flex;"><span>000D1092   .  85C0          test    eax, eax
</span></span><span style="display:flex;"><span>000D1094      74 23         je      short 000D10B9
</span></span><span style="display:flex;"><span>000D1096   &gt;  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1097   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1098   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1099   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D109A      CC            int3
</span></span><span style="display:flex;"><span>000D109B   .  8B55 F4       mov     edx, dword ptr [ebp-C]
</span></span><span style="display:flex;"><span>000D109E   .  E8 5DFFFFFF   call    000D1000
</span></span><span style="display:flex;"><span>000D10A3      EB 4A         jmp     short 000D10EF
</span></span></code></pre></div><p>关键就是对这些汇编语句进行修改来获得flag数据，运行过程中有一个int3断点应该是让程序进行终止的，然后就是je跳转语句和jmp跳转语句了。对je跳转语句进行修改和jmp跳转语句进行修改，设置断点进行调试应该就可以获得flag</p>
<p>修改过的汇编语句</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>000D1083   .  E8 A2FFFFFF   call    000D102A
</span></span><span style="display:flex;"><span>000D1088   .  85C0          test    eax, eax
</span></span><span style="display:flex;"><span>000D108A   .  75 0A         jnz     short 000D1096
</span></span><span style="display:flex;"><span>000D108C   .  FF15 14600D00 call    dword ptr [&lt;&amp;KERNEL32.IsDebugger&gt;; [IsDebuggerPresent
</span></span><span style="display:flex;"><span>000D1092   .  85C0          test    eax, eax
</span></span><span style="display:flex;"><span>000D1094      90            nop
</span></span><span style="display:flex;"><span>000D1095      90            nop
</span></span><span style="display:flex;"><span>000D1096   &gt;  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1097   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1098   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D1099   .  41            inc     ecx
</span></span><span style="display:flex;"><span>000D109A      90            nop
</span></span><span style="display:flex;"><span>000D109B   .  8B55 F4       mov     edx, dword ptr [ebp-C]
</span></span><span style="display:flex;"><span>000D109E   .  E8 5DFFFFFF   call    000D1000
</span></span><span style="display:flex;"><span>000D10A3      EB 14         jmp     short 000D10B9
</span></span></code></pre></div><p>然后设置断点进行调试，来获得flag</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210913085300812.png" alt="image-20210913085300812" />
      
    </figure>
  

</p>
<p>成功得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>flag{reversing_is_not_that_hard!}
</span></span></code></pre></div><h2 id="0xb-maze" class="relative group">0xB maze <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#0xb-maze" aria-label="Anchor">#</a></span></h2>
<p>走迷宫的题目，逆向题目中多少有些趣味的题目，来一起走迷宫吧</p>
<p>首先查看一下程序信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210913085802357.png" alt="image-20210913085802357" />
      
    </figure>
  

</p>
<p>64位的程序，使用x64 IDA pro查看一下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">__int64</span> <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> a1, <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>a2, <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>a3)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">__int64</span> v3; <span style="color:#75715e">// rbx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v4; <span style="color:#75715e">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v5; <span style="color:#75715e">// bp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v6; <span style="color:#75715e">// al
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>v7; <span style="color:#75715e">// rdi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v9; <span style="color:#75715e">// [rsp+0h] [rbp-28h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v10[<span style="color:#ae81ff">9</span>]; <span style="color:#75715e">// [rsp+4h] [rbp-24h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  v10[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  v9 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  puts(<span style="color:#e6db74">&#34;Input flag:&#34;</span>);
</span></span><span style="display:flex;"><span>  scanf(<span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#f92672">&amp;</span>s1);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( strlen(<span style="color:#f92672">&amp;</span>s1) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">||</span> strncmp(<span style="color:#f92672">&amp;</span>s1, <span style="color:#e6db74">&#34;nctf{&#34;</span>, <span style="color:#ae81ff">5uLL</span>) <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>(<span style="color:#f92672">&amp;</span>byte_6010BF <span style="color:#f92672">+</span> <span style="color:#ae81ff">24</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">125</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>LABEL_22:
</span></span><span style="display:flex;"><span>    puts(<span style="color:#e6db74">&#34;Wrong flag!&#34;</span>);
</span></span><span style="display:flex;"><span>    exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">5LL</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( strlen(<span style="color:#f92672">&amp;</span>s1) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">5</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> ( <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v4 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#f92672">&amp;</span>s1 <span style="color:#f92672">+</span> v3);
</span></span><span style="display:flex;"><span>      v5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( v4 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">78</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">79</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400650(v10);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">goto</span> LABEL_14;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">111</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400660(v10);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">goto</span> LABEL_14;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">46</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400670(<span style="color:#f92672">&amp;</span>v9);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">goto</span> LABEL_14;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">48</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400680(<span style="color:#f92672">&amp;</span>v9);
</span></span><span style="display:flex;"><span>LABEL_14:
</span></span><span style="display:flex;"><span>          v5 <span style="color:#f92672">=</span> v6;
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">goto</span> LABEL_15;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>LABEL_15:
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)sub_400690(asc_601060, (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)v10[<span style="color:#ae81ff">0</span>], v9) )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">goto</span> LABEL_22;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">++</span>v3 <span style="color:#f92672">&gt;=</span> strlen(<span style="color:#f92672">&amp;</span>s1) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( v5 )
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>LABEL_20:
</span></span><span style="display:flex;"><span>        v7 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Wrong flag!&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">goto</span> LABEL_21;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( asc_601060[<span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> v9 <span style="color:#f92672">+</span> v10[<span style="color:#ae81ff">0</span>]] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">35</span> )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">goto</span> LABEL_20;
</span></span><span style="display:flex;"><span>  v7 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Congratulations!&#34;</span>;
</span></span><span style="display:flex;"><span>LABEL_21:
</span></span><span style="display:flex;"><span>  puts(v7);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>函数的主要逻辑应该是根据输入的值来进行走迷宫的，走出迷宫即得到flag。程序中肯定存在的有迷宫的地图作为静态数据存储。所以可以尝试查看静态数据：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/XCTF-REVERSE-novice_writeup/image-20210913091057871.png" alt="image-20210913091057871" />
      
    </figure>
  

</p>
<p>果然有一个类似迷宫的数据，查看迷宫数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  *******   *  **** * ****  * ***  *#  *** *** ***     *********
</span></span></code></pre></div><p>需要对代码进行分析来进一步得到迷宫的大致样子</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( strlen(<span style="color:#f92672">&amp;</span>s1) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">||</span> strncmp(<span style="color:#f92672">&amp;</span>s1, <span style="color:#e6db74">&#34;nctf{&#34;</span>, <span style="color:#ae81ff">5uLL</span>) <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>(<span style="color:#f92672">&amp;</span>byte_6010BF <span style="color:#f92672">+</span> <span style="color:#ae81ff">24</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">125</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>LABEL_22:
</span></span><span style="display:flex;"><span>    puts(<span style="color:#e6db74">&#34;Wrong flag!&#34;</span>);
</span></span><span style="display:flex;"><span>    exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>根据这段代码可以判断出走出迷宫需要18个操作数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> ( <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v4 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#f92672">&amp;</span>s1 <span style="color:#f92672">+</span> v3);
</span></span><span style="display:flex;"><span>      v5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( v4 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">78</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;O&#39;</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400650(v10);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">goto</span> LABEL_14;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;o&#39;</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400660(v10);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">goto</span> LABEL_14;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;.&#39;</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400670(<span style="color:#f92672">&amp;</span>v9);
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">goto</span> LABEL_14;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)v4 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;0&#39;</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          v6 <span style="color:#f92672">=</span> sub_400680(<span style="color:#f92672">&amp;</span>v9);
</span></span></code></pre></div><p>这些是对迷宫操作的判断，根据这些判断可以确定我们如何进行迷宫的操作</p>
<p>首先根据反汇编的代码进行分析，可以发现有两个关键数据有着比较重要的作用就是<code>v10</code>就<code>v9</code>的数据，根据跟进分析，发现<code>v10</code> 是进行横向操作，发现<code>v9</code> 是纵向操作。然后根据函数内部的加或减来确定 上下左右 的方向。</p>
<p>对代码进行进一步分析应该就知道对应操作：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&#39;O&#39;  ←
</span></span><span style="display:flex;"><span>&#39;o&#39;  →
</span></span><span style="display:flex;"><span>&#39;.&#39;  ↑
</span></span><span style="display:flex;"><span>&#39;0&#39;  ↓
</span></span></code></pre></div><p>根据代码的分析，迷宫应该是8x8的迷宫，可以排列出迷宫的样子</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>00******
</span></span><span style="display:flex;"><span>*000*00*
</span></span><span style="display:flex;"><span>***0*0**
</span></span><span style="display:flex;"><span>**00*0**
</span></span><span style="display:flex;"><span>*00*#00*
</span></span><span style="display:flex;"><span>**0***0*
</span></span><span style="display:flex;"><span>**00000*
</span></span><span style="display:flex;"><span>********
</span></span></code></pre></div><p>根据目前的分析的结果就可以开心地走迷宫了：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>o0oo00O000oooo..OO
</span></span></code></pre></div><p>迷宫路线即为flag，因此本题的flag为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>nctf{o0oo00O000oooo..OO}
</span></span></code></pre></div>
      </div>
      <script>

        var liked_article = false

        if (typeof auth !== 'undefined') {
          var oid = "views_posts\\XCTF-REVERSE-novice_writeup.md"
          var id = oid ? oid.replaceAll("/", "-") : oid

          var viewed = localStorage.getItem(id);

          if (!viewed) {
            auth.signInAnonymously()
              .then(() => {
                var docRef = db.collection('views').doc(id)
                localStorage.setItem(id, true);
                docRef.get().then((doc) => {
                  if (doc.exists) {
                    db.collection('views').doc(id).update({
                      views: firebase.firestore.FieldValue.increment(1)
                    });
                  } else {
                    db.collection('views').doc(id).set({ views: 1 })
                  }
                }).catch((error) => {
                  console.log("Error getting document:", error);
                });
              })
              .catch((error) => {
                var errorCode = error.code;
                var errorMessage = error.message;
                console.error(errorCode, errorMessage)
              });
          }

          var oid_likes = "likes_posts\\XCTF-REVERSE-novice_writeup.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes

          var liked = localStorage.getItem(id_likes);

          if (liked) {
            liked_article = true
            document.querySelectorAll("button[id='likes_button']")[0].innerText = "Remove Like"
          }

        }

        function like_article(id_likes) {
          console.log("add")
          liked_article = true
          localStorage.setItem(id_likes, true);
          document.querySelectorAll("button[id='likes_button']")[0].innerText = "Remove Like"
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 1 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function remove_like_article(id_likes) {
          console.log("remove")
          liked_article = false
          localStorage.setItem(id_likes, false);
          document.querySelectorAll("button[id='likes_button']")[0].innerText = "Like"
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(-1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 0 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function process_article() {
          var oid_likes = "likes_posts\\XCTF-REVERSE-novice_writeup.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes
          if (!liked_article) {
            like_article(id_likes)
          } else {
            remove_like_article(id_likes)
          }
        }
      </script>
  </section>
  <footer class="pt-8 max-w-prose print:hidden">
    
  <div class="flex">
    
      
      
        
        <img
          class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
          width="96"
          height="96"
          alt="OolongCode"
          src="/img/orca_hua93937f76bd5e462e54a483861805696_158669_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
          Author
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          OolongCode
        </div>
      
      
        <div class="text-sm text-neutral-700 dark:text-neutral-400">OolongCode and OrcasCode&rsquo;s CyberSpace!</div>
      
      <div class="text-2xl sm:text-lg">
</div>
    </div>
  </div>


    
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.codetea.top/posts/xctf-reverse-novice_writeup/&amp;title=XCTF%20REVERSE%20novice_writeup"
          title="Share on LinkedIn"
          aria-label="Share on LinkedIn"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://twitter.com/intent/tweet/?url=https://www.codetea.top/posts/xctf-reverse-novice_writeup/&amp;text=XCTF%20REVERSE%20novice_writeup"
          title="Tweet on Twitter"
          aria-label="Tweet on Twitter"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</a
        >
      
    
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.codetea.top/posts/xctf-reverse-novice_writeup/&amp;description=XCTF%20REVERSE%20novice_writeup"
          title="Pin on Pinterest"
          aria-label="Pin on Pinterest"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://reddit.com/submit/?url=https://www.codetea.top/posts/xctf-reverse-novice_writeup/&amp;resubmit=true&amp;title=XCTF%20REVERSE%20novice_writeup"
          title="Submit to Reddit"
          aria-label="Submit to Reddit"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.facebook.com/sharer/sharer.php?u=https://www.codetea.top/posts/xctf-reverse-novice_writeup/&amp;quote=XCTF%20REVERSE%20novice_writeup"
          title="Share on Facebook"
          aria-label="Share on Facebook"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="mailto:?body=https://www.codetea.top/posts/xctf-reverse-novice_writeup/&amp;subject=XCTF%20REVERSE%20novice_writeup"
          title="Send via email"
          aria-label="Send via email"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</a
        >
      
    
  </section>


    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/posts/buuctf-reverse-1_writeup/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >BUUCTF REVERSE [1~8]_writeup</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-10-14 13:03:43 &#43;0800 CST">October 14, 2021</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group" href="/posts/buuctf-reverse-2_writeup/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >BUUCTF REVERSE [9~16]_Writeup</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-01-28 19:18:38 &#43;0800 CST">January 28, 2022</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

        
          <div
            class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"
          >
            <a
              href="#the-top"
              class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
    <ul class="flex flex-col list-none sm:flex-row">
      
      <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/categories/"
          title="Categories">Categories</a>
      </li>
      
      <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/tags/"
          title="Tags">Tags</a>
      </li>
      
    </ul>
  </nav>
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2022
      OolongCode
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://nunocoracao.github.io/blowfish/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.1d5a3f4a9583d31668d777478074c0526be93b07cc79f303dce0ecc502226b04072b27e78185a927a25fd226da1de5a457c13cb89c85596512bd500006ee7602.js" integrity="sha512-HVo/SpWD0xZo13dHgHTAUmvpOwfMefMD3ODsxQIiawQHKyfngYWpJ6Jf0ibaHeWkV8E8uJyFWWUSvVAABu52Ag=="></script>
  
  
</footer><div
  id="search-wrapper"
  class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://www.codetea.top/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
