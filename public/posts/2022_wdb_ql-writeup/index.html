

<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>2022 网鼎杯 青龙组 Writeup &middot; OPdbg</title>
  <meta name="title" content="2022 网鼎杯 青龙组 Writeup &middot; OPdbg" />
  
  
  
  
  
  <link rel="canonical" href="https://www.codetea.top/posts/2022_wdb_ql-writeup/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.69dfbd88ef7129902eaf1aee00660b4e9203142083f65f0194c832847f8b2a3782d909a54a812b51f6d40fbc4f9361ef007efd6259112be1875826f850711dd5.css"
    integrity="sha512-ad&#43;9iO9xKZAurxruAGYLTpIDFCCD9l8BlMgyhH&#43;LKjeC2QmlSoErUfbUD7xPk2HvAH79YlkRK&#43;GHWCb4UHEd1Q==" />
  
  
  <script type="text/javascript" src="/js/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js" integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP&#43;DGNKHfuwvY7kxvUdBeoGlODJ6&#43;SfaPg=="></script>
  
  
  <script type="text/javascript" src="/js/appearance.min.f94f4c4636d9e3ec8f5ee53cdc8ffa3d01bf87cd92ac85e6797550b1e2b80dc9118d838f3eb24c55109352455e72ff082dfe560283154e5a8f87fd75107b59c4.js"
    integrity="sha512-&#43;U9MRjbZ4&#43;yPXuU83I/6PQG/h82SrIXmeXVQseK4DckRjYOPPrJMVRCTUkVecv8ILf5WAoMVTlqPh/11EHtZxA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.3505add38a70acba51f9557ef4857df3e22668f612f62e52b3d5c4206205c5466595b8aeab4e238ac2225b9ff74bff24fee5b8d68940264e5bac7d35f1d7d7b5.js"
    integrity="sha512-NQWt04pwrLpR&#43;VV&#43;9IV98&#43;ImaPYS9i5Ss9XEIGIFxUZllbiuq04jisIiW5/3S/8k/uW41olAJk5brH018dfXtQ==" data-copy="" data-copied=""></script>
  
  <script src="/js/zoom.min.js"></script>
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="2022 网鼎杯 青龙组 Writeup" />
<meta property="og:description" content="2022 网鼎杯 青龙组 Writeup # 今年网鼎杯的逆向题目是相对来说比较简单的，在比赛的时候做出了两道逆向题目。
第二道逆向apk的题目找到文章了，但是去看Crypto的题目了，也就没有认真去钻逆向的那道题目。
Crypto题目由于自身的数学敏感度不够没能解出，还需要继续提高
解出 # fakeshell # 题目给到了一个exe文件，使用die查看该文件：
发现是一个upx压缩壳加密的程序，尝试使用upx脱壳：
发现壳可能被修改过，需要手动脱壳。先尝试运行下程序，寻找下可能存在的锚点字符串信息：
找到两个锚点字符串，一个是&lt;&lt;Input your flag:，另一个是Wrong.
使用x64dbg进行手动脱壳，进行入口点的测试找到一个关键跳转地址0x1400276CB
这是一个长跳转指令，运行到这个指令的时候程序已经完成解密。可以对程序的内存引用进行查看：
发现程序的内存引用中已经出现了锚点字符串，说明此时的程序已经完成了解密。然后跟进到锚点字符串所在的函数位置：
这个位置应该是主函数空间，在这个主函数空间中对函数开头位置下断点，然后让程序运行到断点位置
然后使用x64dbg的Scylla插件进行dump内存：
从当前位置进行dump即可，得到一个dump的程序。
现在完成手动脱壳，进入到下一步，进行ida pro的静态分析：
使用F5插件来查看程序反编译的代码进行分析
输入的数据存储到v4变量中，对v4变量处理的函数有两个，对这两个函数依次进行审计。
首先分析第一个函数，这个函数要一直跟进跟进到和参数有关的位置
第一个函数中，存在一个判断和一个异或运算。
判断是对输入的数据进行了处理，猜测应该是进行长度判断，判断长度是否是20位。
异或操作是单纯对于输入数据的运行对于程序运行流程没有太多影响
分析第二个函数，和第一个函数的跟进方法类似
第二个函数同样也有一个异或操作和一个特殊的函数，跟进这个函数查看：
发现判断的位置有密文，跟进密文查看：
使用shift&#43; E将数据提取出来，可以得到：
unsigned char ida_chars[] = { 0x4B, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x79, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x5C, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x5A, 0x00, 0x00, 0x00, 0x79, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x70, 0x00, 0x00, 0x00, 0x6D, 0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x6F, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x5D, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }; 显然是以4字节，小端序存储的" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.codetea.top/posts/2022_wdb_ql-writeup/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-31T17:28:44+08:00" />
<meta property="article:modified_time" content="2022-08-31T17:28:44+08:00" /><meta property="og:site_name" content="OPdbg" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="2022 网鼎杯 青龙组 Writeup"/>
<meta name="twitter:description" content="2022 网鼎杯 青龙组 Writeup # 今年网鼎杯的逆向题目是相对来说比较简单的，在比赛的时候做出了两道逆向题目。
第二道逆向apk的题目找到文章了，但是去看Crypto的题目了，也就没有认真去钻逆向的那道题目。
Crypto题目由于自身的数学敏感度不够没能解出，还需要继续提高
解出 # fakeshell # 题目给到了一个exe文件，使用die查看该文件：
发现是一个upx压缩壳加密的程序，尝试使用upx脱壳：
发现壳可能被修改过，需要手动脱壳。先尝试运行下程序，寻找下可能存在的锚点字符串信息：
找到两个锚点字符串，一个是&lt;&lt;Input your flag:，另一个是Wrong.
使用x64dbg进行手动脱壳，进行入口点的测试找到一个关键跳转地址0x1400276CB
这是一个长跳转指令，运行到这个指令的时候程序已经完成解密。可以对程序的内存引用进行查看：
发现程序的内存引用中已经出现了锚点字符串，说明此时的程序已经完成了解密。然后跟进到锚点字符串所在的函数位置：
这个位置应该是主函数空间，在这个主函数空间中对函数开头位置下断点，然后让程序运行到断点位置
然后使用x64dbg的Scylla插件进行dump内存：
从当前位置进行dump即可，得到一个dump的程序。
现在完成手动脱壳，进入到下一步，进行ida pro的静态分析：
使用F5插件来查看程序反编译的代码进行分析
输入的数据存储到v4变量中，对v4变量处理的函数有两个，对这两个函数依次进行审计。
首先分析第一个函数，这个函数要一直跟进跟进到和参数有关的位置
第一个函数中，存在一个判断和一个异或运算。
判断是对输入的数据进行了处理，猜测应该是进行长度判断，判断长度是否是20位。
异或操作是单纯对于输入数据的运行对于程序运行流程没有太多影响
分析第二个函数，和第一个函数的跟进方法类似
第二个函数同样也有一个异或操作和一个特殊的函数，跟进这个函数查看：
发现判断的位置有密文，跟进密文查看：
使用shift&#43; E将数据提取出来，可以得到：
unsigned char ida_chars[] = { 0x4B, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x79, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x5C, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x5A, 0x00, 0x00, 0x00, 0x79, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x70, 0x00, 0x00, 0x00, 0x6D, 0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x6F, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x5D, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }; 显然是以4字节，小端序存储的"/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "2022 网鼎杯 青龙组 Writeup",
    "headline": "2022 网鼎杯 青龙组 Writeup",
    
    "abstract": "2022 网鼎杯 青龙组 Writeup # 今年网鼎杯的逆向题目是相对来说比较简单的，在比赛的时候做出了两道逆向题目。\n第二道逆向apk的题目找到文章了，但是去看Crypto的题目了，也就没有认真去钻逆向的那道题目。\nCrypto题目由于自身的数学敏感度不够没能解出，还需要继续提高\n解出 # fakeshell # 题目给到了一个exe文件，使用die查看该文件：\n发现是一个upx压缩壳加密的程序，尝试使用upx脱壳：\n发现壳可能被修改过，需要手动脱壳。先尝试运行下程序，寻找下可能存在的锚点字符串信息：\n找到两个锚点字符串，一个是\u0026lt;\u0026lt;Input your flag:，另一个是Wrong.\n使用x64dbg进行手动脱壳，进行入口点的测试找到一个关键跳转地址0x1400276CB\n这是一个长跳转指令，运行到这个指令的时候程序已经完成解密。可以对程序的内存引用进行查看：\n发现程序的内存引用中已经出现了锚点字符串，说明此时的程序已经完成了解密。然后跟进到锚点字符串所在的函数位置：\n这个位置应该是主函数空间，在这个主函数空间中对函数开头位置下断点，然后让程序运行到断点位置\n然后使用x64dbg的Scylla插件进行dump内存：\n从当前位置进行dump即可，得到一个dump的程序。\n现在完成手动脱壳，进入到下一步，进行ida pro的静态分析：\n使用F5插件来查看程序反编译的代码进行分析\n输入的数据存储到v4变量中，对v4变量处理的函数有两个，对这两个函数依次进行审计。\n首先分析第一个函数，这个函数要一直跟进跟进到和参数有关的位置\n第一个函数中，存在一个判断和一个异或运算。\n判断是对输入的数据进行了处理，猜测应该是进行长度判断，判断长度是否是20位。\n异或操作是单纯对于输入数据的运行对于程序运行流程没有太多影响\n分析第二个函数，和第一个函数的跟进方法类似\n第二个函数同样也有一个异或操作和一个特殊的函数，跟进这个函数查看：\n发现判断的位置有密文，跟进密文查看：\n使用shift\u002b E将数据提取出来，可以得到：\nunsigned char ida_chars[] = { 0x4B, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x79, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x5C, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x5A, 0x00, 0x00, 0x00, 0x79, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x70, 0x00, 0x00, 0x00, 0x6D, 0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x6F, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x5D, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }; 显然是以4字节，小端序存储的",
    "inLanguage": "en",
    "url" : "https:\/\/www.codetea.top\/posts\/2022_wdb_ql-writeup\/",
    "author" : {
      "@type": "Person",
      "name": "OolongCode"
    },
    "copyrightYear": "2022",
    "dateCreated": "2022-08-31T17:28:44\u002b08:00",
    "datePublished": "2022-08-31T17:28:44\u002b08:00",
    
    "dateModified": "2022-08-31T17:28:44\u002b08:00",
    
    "keywords": ["writeup","ctf"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1911"
  }]
  </script>


  
  
  <meta name="author" content="OolongCode" />
  
  
  






  
  
  
  


  
  
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  
  
  
</head><body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400"
          >&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <div style="padding-left:0;padding-right:0"
    class="flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">OPdbg</a>
            
            
        </nav>
        <div class="hidden md:flex items-center space-x-5 md:ml-12">

            
            
            <a href="/about/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="About">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


                 &nbsp; 
                About
            </a>
            
            <a href="/posts/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="Posts">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


                 &nbsp; 
                Posts
            </a>
            
            <a href="/link/" class="text-base font-medium text-gray-500 hover:text-gray-900" title="Link">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>


                 &nbsp; 
                Link
            </a>
            
            <a href="https://github.com/OolongCode" class="text-base font-medium text-gray-500 hover:text-gray-900" title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                
                
            </a>
            
            

            


            
            <button id="search-button" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            
            <div
                class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
                <button id="appearance-switcher" type="button">
                    <div class="flex items-center justify-center h-12 dark:hidden">
                        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden h-12 dark:flex">
                        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </div>
        <div class="flex md:hidden items-center space-x-5 md:ml-12">

            <span></span>

            


            
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" type="button" style="margin-right:5px">
                <div class="flex items-center justify-center h-12 dark:hidden">
                    

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden h-12 dark:flex">
                    

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:25px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
                    <li class="mb-1">
                        <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/about/" title="About">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


                             &nbsp; 
                            About
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/posts/" title="Posts">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


                             &nbsp; 
                            Posts
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/link/" title="Link">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>


                             &nbsp; 
                            Link
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="https://github.com/OolongCode" title="">
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                            
                            
                        </a>
                    </li>
                    
                    

                </ul>
            </div>
        </label>
    </div>
</div>


<div id="mobile-menu"
    class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
    <ul
        class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
        <li class="mb-1">
            <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
        </li>
        
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/about/" title="About">About</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/" title="Posts">Posts</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/link/" title="Link">Link</a>
        </li>
        
        <li class="mb-1">
            <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="https://github.com/OolongCode" title=""></a>
        </li>
        
        
        
        <li>
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
        </li>
        
    </ul>
</div>
    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
<article>
  <header class="max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >OPdbg</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/2022_wdb_ql-writeup/"
      >2022 网鼎杯 青龙组 Writeup</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      2022 网鼎杯 青龙组 Writeup
    </h1>
    <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      






































<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2022-08-31 17:28:44 &#43;0800 CST">August 31, 2022</time><span class="px-2 text-primary-500">&middot;</span><span>1911 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">9 mins</span><span class="px-2 text-primary-500">&middot;</span>


  
    
  
  

<span class="mb-[2px]">
  <a
    href="#/posts/2022_WDB_QL-writeup.md"
    class="text-lg hover:text-primary-500"
    rel="noopener noreferrer"
    target="_blank"
    title="Edit content"
    >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M490.3 40.4C512.2 62.27 512.2 97.73 490.3 119.6L460.3 149.7L362.3 51.72L392.4 21.66C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7L339.7 74.34L437.7 172.3L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2L159.6 382.8C150.1 385.6 141.5 383.4 135 376.1C128.6 370.5 126.4 361 129.2 352.4L158.8 263.6C161.6 255.3 166.2 247.8 172.4 241.7V241.7zM192 63.1C209.7 63.1 224 78.33 224 95.1C224 113.7 209.7 127.1 192 127.1H96C78.33 127.1 64 142.3 64 159.1V416C64 433.7 78.33 448 96 448H352C369.7 448 384 433.7 384 416V319.1C384 302.3 398.3 287.1 416 287.1C433.7 287.1 448 302.3 448 319.1V416C448 469 405 512 352 512H96C42.98 512 0 469 0 416V159.1C0 106.1 42.98 63.1 96 63.1H192z"/></svg>

  </span>

</a
  >
</span>
  

  
  



</div>






    </div>
  </header>
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
     <div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">
        <details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#解出">解出</a>
      <ul>
        <li><a href="#fakeshell">fakeshell</a></li>
        <li><a href="#handmake">Handmake</a></li>
      </ul>
    </li>
    <li><a href="#复现">复现</a>
      <ul>
        <li><a href="#crypto091">Crypto091</a></li>
        <li><a href="#grasshopper">grasshopper</a></li>
        <li><a href="#david_homework">david_homework</a></li>
        <li><a href="#whereiscode">whereiscode</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#解出">解出</a>
      <ul>
        <li><a href="#fakeshell">fakeshell</a></li>
        <li><a href="#handmake">Handmake</a></li>
      </ul>
    </li>
    <li><a href="#复现">复现</a>
      <ul>
        <li><a href="#crypto091">Crypto091</a></li>
        <li><a href="#grasshopper">grasshopper</a></li>
        <li><a href="#david_homework">david_homework</a></li>
        <li><a href="#whereiscode">whereiscode</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

      </div>
      </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <h1 id="2022-网鼎杯-青龙组-writeup" class="relative group">2022 网鼎杯 青龙组 Writeup <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#2022-%e7%bd%91%e9%bc%8e%e6%9d%af-%e9%9d%92%e9%be%99%e7%bb%84-writeup" aria-label="Anchor">#</a></span></h1>
<p>今年网鼎杯的逆向题目是相对来说比较简单的，在比赛的时候做出了两道逆向题目。</p>
<p>第二道逆向apk的题目找到文章了，但是去看Crypto的题目了，也就没有认真去钻逆向的那道题目。</p>
<p>Crypto题目由于自身的数学敏感度不够没能解出，还需要继续提高</p>
<h2 id="解出" class="relative group">解出 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e8%a7%a3%e5%87%ba" aria-label="Anchor">#</a></span></h2>
<h3 id="fakeshell" class="relative group">fakeshell <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#fakeshell" aria-label="Anchor">#</a></span></h3>
<p>题目给到了一个exe文件，使用die查看该文件：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828123956402.png" alt="image-20220828123956402" />
      
    </figure>
  

</p>
<p>发现是一个upx压缩壳加密的程序，尝试使用upx脱壳：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828133038392.png" alt="image-20220828133038392" />
      
    </figure>
  

</p>
<p>发现壳可能被修改过，需要手动脱壳。先尝试运行下程序，寻找下可能存在的锚点字符串信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828140533175.png" alt="image-20220828140533175" />
      
    </figure>
  

</p>
<p>找到两个锚点字符串，一个是<code>&lt;&lt;Input your flag:</code>，另一个是<code>Wrong.</code></p>
<p>使用x64dbg进行手动脱壳，进行入口点的测试找到一个关键跳转地址0x1400276CB</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828140317972.png" alt="image-20220828140317972" />
      
    </figure>
  

</p>
<p>这是一个长跳转指令，运行到这个指令的时候程序已经完成解密。可以对程序的内存引用进行查看：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828140739058.png" alt="image-20220828140739058" />
      
    </figure>
  

</p>
<p>发现程序的内存引用中已经出现了锚点字符串，说明此时的程序已经完成了解密。然后跟进到锚点字符串所在的函数位置：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828140905779.png" alt="image-20220828140905779" />
      
    </figure>
  

</p>
<p>这个位置应该是主函数空间，在这个主函数空间中对函数开头位置下断点，然后让程序运行到断点位置</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828141834266.png" alt="image-20220828141834266" />
      
    </figure>
  

</p>
<p>然后使用x64dbg的Scylla插件进行dump内存：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828142149592.png" alt="image-20220828142149592" />
      
    </figure>
  

</p>
<p>从当前位置进行dump即可，得到一个dump的程序。</p>
<p>现在完成手动脱壳，进入到下一步，进行ida pro的静态分析：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828142350437.png" alt="image-20220828142350437" />
      
    </figure>
  

</p>
<p>使用F5插件来查看程序反编译的代码进行分析</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828142457029.png" alt="image-20220828142457029" />
      
    </figure>
  

</p>
<p>输入的数据存储到v4变量中，对v4变量处理的函数有两个，对这两个函数依次进行审计。</p>
<p>首先分析第一个函数，这个函数要一直跟进跟进到和参数有关的位置</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828142835318.png" alt="image-20220828142835318" />
      
    </figure>
  

</p>
<p>第一个函数中，存在一个判断和一个异或运算。</p>
<p>判断是对输入的数据进行了处理，猜测应该是进行长度判断，判断长度是否是20位。</p>
<p>异或操作是单纯对于输入数据的运行对于程序运行流程没有太多影响</p>
<p>分析第二个函数，和第一个函数的跟进方法类似</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828144648807.png" alt="image-20220828144648807" />
      
    </figure>
  

</p>
<p>第二个函数同样也有一个异或操作和一个特殊的函数，跟进这个函数查看：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828145157336.png" alt="image-20220828145157336" />
      
    </figure>
  

</p>
<p>发现判断的位置有密文，跟进密文查看：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828145310441.png" alt="image-20220828145310441" />
      
    </figure>
  

</p>
<p>使用<code>shift</code>+ <code>E</code>将数据提取出来，可以得到：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> ida_chars[] <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x5A</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x5D</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>显然是以4字节，小端序存储的</p>
<p>现在获取的密文和两次运算，编写脚本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>c <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x5A</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x5D</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span> ]
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> c[::<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">0x14</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x14</span>):
</span></span><span style="display:flex;"><span>    flag[i] <span style="color:#f92672">=</span> chr(((c[i]<span style="color:#f92672">^</span><span style="color:#ae81ff">0x50</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">^</span><span style="color:#ae81ff">0x66</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(flag))
</span></span></code></pre></div><p>运行得到flag：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>why_m0dify_pUx_SheLL
</span></span></code></pre></div><h3 id="handmake" class="relative group">Handmake <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#handmake" aria-label="Anchor">#</a></span></h3>
<p>这道题目是手工，应该是需要手工寻找一些内容</p>
<p>题目给到了一个go程序的源码：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828150430370.png" alt="image-20220828150430370" />
      
    </figure>
  

</p>
<p>总共有大约15w行的代码，尝试编译运行：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828150855335.png" alt="image-20220828150855335" />
      
    </figure>
  

</p>
<p>应该是英文的阅读理解找函数的题目，理解这两句话的意思就可以求解。</p>
<p><code>Input the first function, which has 6 parameters and the third named gLIhR: </code></p>
<p>这句话就是找到一个有六个参数的函数而且第三个参数是<code>gLIhR</code></p>
<p><code>Input the second function, which has 3 callers and invokes the function named cHZv5op8rOmlAkb6:</code></p>
<p>这句话就是找到一个函数，这个函数被调用了3次并且调用了一个名为<code>cHZv5op8rOmlAkb6</code>函数。</p>
<p>根据要求去寻找函数名：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828151548954.png" alt="image-20220828151548954" />
      
    </figure>
  

</p>
<p>然后进行程序的测试就可以得到flag：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828151706620.png" alt="image-20220828151706620" />
      
    </figure>
  

</p>
<h2 id="复现" class="relative group">复现 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e5%a4%8d%e7%8e%b0" aria-label="Anchor">#</a></span></h2>
<h3 id="crypto091" class="relative group">Crypto091 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#crypto091" aria-label="Anchor">#</a></span></h3>
<p>这道题目被队友解答，我就没有进行看了，赛后进行复现下</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828152017556.png" alt="image-20220828152017556" />
      
    </figure>
  

</p>
<p>这道题目要寻找到关键信息，本道题目的关键信息有：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>170号段首批放号的联通号码
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Hash：
</span></span><span style="display:flex;"><span>c22a563acc2a587afbfaaaa6d67bc6e628872b00bd7e998873881f7c6fdc62fc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag格式：flag{13位电话号码（纯数字，含国家代码）}
</span></span></code></pre></div><p>使用搜索引擎进行查找：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828153105747.png" alt="image-20220828153105747" />
      
    </figure>
  

</p>
<p>1709是首批号码段，下面是对hash的类型进行猜测，首先看看哈希的长度：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828153953231.png" alt="image-20220828153953231" />
      
    </figure>
  

</p>
<p>hash数据的长度是64位可能是sha256加密，可以使用hacker工具Hashcat进行爆破求解：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hashcat -m <span style="color:#ae81ff">1400</span> -a <span style="color:#ae81ff">3</span> c22a563acc2a587afbfaaaa6d67bc6e628872b00bd7e998873881f7c6fdc62fc 861709?d?d?d?d?d?d?d
</span></span></code></pre></div><p>运行得到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220828155215870.png" alt="image-20220828155215870" />
      
    </figure>
  

</p>
<p>由此可以得到tel是8617091733716，故flag是<code>flag{8617091733716}</code></p>
<h3 id="grasshopper" class="relative group">grasshopper <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#grasshopper" aria-label="Anchor">#</a></span></h3>
<blockquote>
<p>这道题目当时代码没有审计清楚，采用Z3-solver进行求解，未能求解成功</p>
</blockquote>
<p>题目给到一个python源码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> randrange
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> grassfield <span style="color:#f92672">import</span> flag
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> [randrange(<span style="color:#ae81ff">1</span>,p) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(flag)):
</span></span><span style="display:flex;"><span>    grasshopper <span style="color:#f92672">=</span> flag[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>        k[j] <span style="color:#f92672">=</span> grasshopper <span style="color:#f92672">=</span> grasshopper <span style="color:#f92672">*</span> k[j] <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Grasshopper#&#39;</span><span style="color:#f92672">+</span>str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;:&#39;</span><span style="color:#f92672">+</span>hex(grasshopper)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">4</span>))
</span></span></code></pre></div><p>进行审计可以发现：</p>
<p>$$
k_{10} = g_0 =  C_0 \cdot k_{00}\ \text{mod}\ p \\
k_{11} = g_0 =  C_0 \cdot k_{00} \cdot k_{01}\ \text{mod}\ p \\
k_{12} = g_0 =  C_0 \cdot k_{00} \cdot k_{01}\cdot k_{02}\ \text{mod}\ p \\
k_{13} = g_0 =  C_0 \cdot k_{00} \cdot k_{01}\cdot k_{02}\cdot k_{03}\ \text{mod}\ p \\
k_{14} = g_0 =  C_0 \cdot k_{00} \cdot k_{01}\cdot k_{02}\cdot k_{03} \cdot k_{04}\ \text{mod}\ p \\
$$</p>
<p>$$
k_{20} = g_0 =  C_1 \cdot k_{10}\ \text{mod}\ p \\
k_{21} = g_0 =  C_1 \cdot k_{10} \cdot k_{11}\ \text{mod}\ p \\
k_{22} = g_0 =  C_1 \cdot k_{10} \cdot k_{11}\cdot k_{12}\ \text{mod}\ p \\
k_{23} = g_0 =  C_1 \cdot k_{10} \cdot k_{11}\cdot k_{12}\cdot k_{13}\ \text{mod}\ p \\
k_{24} = g_0 =  C_1 \cdot k_{10} \cdot k_{11}\cdot k_{12}\cdot k_{13} \cdot k_{14}\ \text{mod}\ p \\
$$
可以发现有规律存在，已知$k_{14}\ k_{24}\ k_{34}\ k_{44}\ k_{54}$ 可以推出$k_{23}\ k_{33}\ k_{43}\ k_{53}$</p>
<p>同理可以推出$k_{32}\ k_{42}\ k_{52}$，依此可以推出$k_{41}\ k_{51}$ 和$k_{50}$</p>
<p>推导公式：
$$
k_{ij} = k_{i(j+1)} \cdot k_{(i-1)j}^{-1}\ \text{mod}\ p
$$
根据推导公式可以进行求解：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> gmpy2 <span style="color:#f92672">import</span> invert,gcd
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sympy <span style="color:#f92672">import</span> isprime
</span></span><span style="display:flex;"><span>know <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;flag{&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;./output.txt&#39;</span>,<span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f<span style="color:#f92672">.</span>readlines():
</span></span><span style="display:flex;"><span>        line <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        g<span style="color:#f92672">.</span>append(int(line[<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>:],<span style="color:#ae81ff">16</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>maxg <span style="color:#f92672">=</span> max(g)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> range(maxg<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> isprime(p):
</span></span><span style="display:flex;"><span>        g04 <span style="color:#f92672">=</span> g[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        g14 <span style="color:#f92672">=</span> g[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        g13 <span style="color:#f92672">=</span> g14 <span style="color:#f92672">*</span> invert(g04, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g24 <span style="color:#f92672">=</span> g[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>        g23 <span style="color:#f92672">=</span> g24 <span style="color:#f92672">*</span> invert(g14, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g22 <span style="color:#f92672">=</span> g23 <span style="color:#f92672">*</span> invert(g13, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g34 <span style="color:#f92672">=</span> g[<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>        g33 <span style="color:#f92672">=</span> g34 <span style="color:#f92672">*</span> invert(g24, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g32 <span style="color:#f92672">=</span> g33 <span style="color:#f92672">*</span> invert(g23, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g31 <span style="color:#f92672">=</span> g32 <span style="color:#f92672">*</span> invert(g22, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g44 <span style="color:#f92672">=</span> g[<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>        g43 <span style="color:#f92672">=</span> g44 <span style="color:#f92672">*</span> invert(g34, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g42 <span style="color:#f92672">=</span> g43 <span style="color:#f92672">*</span> invert(g33, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g41 <span style="color:#f92672">=</span> g42 <span style="color:#f92672">*</span> invert(g32, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        g40 <span style="color:#f92672">=</span> g41 <span style="color:#f92672">*</span> invert(g31, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">=</span> [g40, g41, g42, g43, g44]
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">42</span>):
</span></span><span style="display:flex;"><span>            _k <span style="color:#f92672">=</span> k[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>k[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>k[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">*</span>k[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">*</span>k[<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>            alp <span style="color:#f92672">=</span> g[i] <span style="color:#f92672">*</span> invert(_k, p) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>            flag <span style="color:#f92672">+=</span> chr(alp)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>                k[j] <span style="color:#f92672">=</span> alp <span style="color:#f92672">=</span> alp <span style="color:#f92672">*</span> k[j] <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> flag<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#39;}&#39;</span>):
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;p = </span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>flag<span style="color:#f92672">.</span>encode())
</span></span></code></pre></div><p>运行代码得到：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>p = 59441
</span></span><span style="display:flex;"><span>b&#39;flag{749d39d4-78db-4c55-b4ff-bca873d0f18e}&#39;
</span></span></code></pre></div><p>这种思路是由局部推断整体的想法，可能将题目的过程复杂化，而显得不是非常优雅。</p>
<hr>
<p>此题的求解脚本还可以使用sagemath进行相应的脚本求解，思路也是大致一样的思路。</p>
<p>构造一个p的整数环，来进行运算求解，这种求解方法反而会更加简单，sagemath求解的脚本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;./output.txt&#39;</span>,<span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f<span style="color:#f92672">.</span>readlines():
</span></span><span style="display:flex;"><span>        line <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        g<span style="color:#f92672">.</span>append(int(line[<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>:],<span style="color:#ae81ff">16</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>maxg <span style="color:#f92672">=</span> max(g)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> range(maxg, <span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> is_prime(p):
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">=</span> g
</span></span><span style="display:flex;"><span>        F <span style="color:#f92672">=</span> GF(p)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>            data <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(flag)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                data<span style="color:#f92672">.</span>append(F(flag[j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">/</span>F(flag[j]))
</span></span><span style="display:flex;"><span>            flag <span style="color:#f92672">=</span> data
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>bytes(data))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>运行脚本就可以得到flag，<code>b'flag{749d39d4-78db-4c55-b4ff-bca873d0f18e}'</code></p>
<p>这种脚本的思路就是直接进行整体运算来求解。</p>
<h3 id="david_homework" class="relative group">david_homework <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#david_homework" aria-label="Anchor">#</a></span></h3>
<blockquote>
<p>这道题目是当时考虑是将递归转循环来进行求解，但是时间复杂度还是很高，不能正常进行求解。想到线性代数的提示，时间已经所剩无几，故未能完成求解</p>
</blockquote>
<p>题目说到是一个线性代数的作业，应该是一个线性代码相关的问题求解。</p>
<p>赛题给到的代码是一个含有递归的函数：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829095725043.png" alt="image-20220829095725043" />
      
    </figure>
  

</p>
<p>通过搜索引擎搜索关键信息</p>
<ol>
<li>搜索 <code>递归函数转线代</code> : <a href="https://blog.csdn.net/wdq347/article/details/8919645">(191条消息) 线性代数求解递推形式数列的通项公式_wdq347的博客-CSDN博客</a></li>
<li>搜索 <code>递推 线代</code> : <a href="https://www.bilibili.com/video/BV18p411o7vc/">线性代数-递推法解“数字型”行列式_哔哩哔哩_bilibili</a></li>
<li>搜索 <code>线性代数-递推法解“数字型”行列式</code> : <a href="https://zhuanlan.zhihu.com/p/37683681">递推公式法在行列式计算中的证明与应用 - 知乎 (zhihu.com)</a></li>
<li>搜索 <code>递推公式法 行列式 </code></li>
</ol>
<p>找到文章：<a href="https://www.zhihu.com/question/426892843">怎么用递归法计算行列式? - 知乎 (zhihu.com)</a></p>
<p>根据文章：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829101251970.png" alt="image-20220829101251970" />
      
    </figure>
  

</p>
<p>显然这道题目是要求求解出逆过程，首先需要抽象出递推函数的递归公式：</p>
<p>$$
f(x,cof) = \left\{
\begin{array}{l}
x+1 &amp; &amp; {x &lt; 3} \\
cof_2\cdot f(x-3) + cof_1\cdot f(x-2) + cof_0\cdot f(x-1) &amp; &amp; {x \geq 3}
\end{array}
\right.
$$</p>
<p>根据查找到的一系列文章中的<a href="https://blog.csdn.net/u011815404/article/details/99621516">(191条消息) 线性代数 —— 线性递推关系_Alex_McAvoy的博客-CSDN博客_线性递推关系</a>，可以看到：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829102307637.png" alt="image-20220829102307637" />
      
    </figure>
  

</p>
<p>根据关系可以得到</p>
<p>$$
f(n) = A * f(n-1) 
$$</p>
<p>$$
A = \left[\begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
cof_2 &amp; cof_1 &amp; cof_0 
\end{array} \right]
$$</p>
<p>$$
f(n-1) = \left[
\begin{array}{l}
f(n-3) \\
f(n-2) \\
f(n-1) \\
\end{array}
\right]
$$</p>
<p>紧接着根据这个：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829104119031.png" alt="image-20220829104119031" />
      
    </figure>
  

</p>
<p>可以得到：
$$
F(n) = A^{n-2}\cdot f(2)
$$</p>
<p>$$
f(2) = \left[
\begin{array}{l}
f(0)\\
f(1) \\
f(2) \\
\end{array}
\right]
= \left[
\begin{array}{l}
1\\
2 \\
3 \\
\end{array}
\right]
$$</p>
<p>尝试使用sagemath求解，出现报错</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829113116331.png" alt="image-20220829113116331" />
      
    </figure>
  

</p>
<p>进行次方运算必须是一个方块矩阵，也就是矩阵的维度必须是2x2, 3x3 … n x n 的矩阵，进行运算推导下：
$$
f(n) = A * f(n-1) = \left[
\begin{array}{c}
f(n-3) \\
f(n-2) \\
f(n-1) \\
cof_2\cdot f(n-3) + cof_1\cdot f(n-2) + cof_0\cdot f(n-1)
\end{array}
\right]
$$</p>
<p>继续进行推导：
$$
f(n-1) = A * f(n-2) = \left[
\begin{array}{c}
f(n-4) \\
f(n-3) \\
f(n-2) \\
cof_2\cdot f(n-4) + cof_1\cdot f(n-3) + cof_0\cdot f(n-2)
\end{array}
\right]
$$</p>
<p>$$
A * f(n-1) \\
= \left[\begin{array}{l}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
cof_2 &amp; cof_1 &amp; cof_0 
\end{array} \right] \cdot \left[
\begin{array}{c}
f(n-4) \\
f(n-3) \\
f(n-2) \\
cof_2\cdot f(n-4) + cof_1\cdot f(n-3) + cof_0\cdot f(n-2)
\end{array}
\right]
$$</p>
<p>此时无法进行运算，进行推导发现将A修改成如下形式运算结果不变：</p>
<p>$$
A = \left[
\begin{array}{ccc}
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
cof_2 &amp; cof_1 &amp; cof_0
\end{array}
\right]
$$</p>
<p>再次尝试编写sage代码进行运算：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># sagemath</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> md5, sha256
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> binascii <span style="color:#f92672">import</span> unhexlify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cof_t <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">353</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1162</span>, <span style="color:#ae81ff">32767</span>], [<span style="color:#ae81ff">206</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8021</span>, <span style="color:#ae81ff">42110</span>], [<span style="color:#ae81ff">262</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7088</span>, <span style="color:#ae81ff">31882</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">388</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6394</span>, <span style="color:#ae81ff">21225</span>], [<span style="color:#ae81ff">295</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9469</span>, <span style="color:#ae81ff">44468</span>], [<span style="color:#ae81ff">749</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3501</span>, <span style="color:#ae81ff">40559</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">528</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2690</span>, <span style="color:#ae81ff">10210</span>], [<span style="color:#ae81ff">354</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5383</span>, <span style="color:#ae81ff">18437</span>], [<span style="color:#ae81ff">491</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8467</span>, <span style="color:#ae81ff">26892</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">932</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6984</span>, <span style="color:#ae81ff">20447</span>], [<span style="color:#ae81ff">731</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6281</span>, <span style="color:#ae81ff">11340</span>], [<span style="color:#ae81ff">420</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5392</span>, <span style="color:#ae81ff">44071</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">685</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6555</span>, <span style="color:#ae81ff">40938</span>], [<span style="color:#ae81ff">408</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8070</span>, <span style="color:#ae81ff">47959</span>], [<span style="color:#ae81ff">182</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9857</span>, <span style="color:#ae81ff">49477</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">593</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3584</span>, <span style="color:#ae81ff">49243</span>], [<span style="color:#ae81ff">929</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7410</span>, <span style="color:#ae81ff">31929</span>], [<span style="color:#ae81ff">970</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4549</span>, <span style="color:#ae81ff">17160</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">141</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2435</span>, <span style="color:#ae81ff">36408</span>], [<span style="color:#ae81ff">344</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3814</span>, <span style="color:#ae81ff">18949</span>], [<span style="color:#ae81ff">291</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7457</span>, <span style="color:#ae81ff">40587</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">765</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7011</span>, <span style="color:#ae81ff">32097</span>], [<span style="color:#ae81ff">700</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8534</span>, <span style="color:#ae81ff">18013</span>], [<span style="color:#ae81ff">267</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2541</span>, <span style="color:#ae81ff">33488</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">249</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8934</span>, <span style="color:#ae81ff">12321</span>], [<span style="color:#ae81ff">589</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9617</span>, <span style="color:#ae81ff">41998</span>], [<span style="color:#ae81ff">840</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1166</span>, <span style="color:#ae81ff">22814</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">947</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5660</span>, <span style="color:#ae81ff">41003</span>], [<span style="color:#ae81ff">206</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7195</span>, <span style="color:#ae81ff">46261</span>], [<span style="color:#ae81ff">784</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9270</span>, <span style="color:#ae81ff">28410</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">338</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3690</span>, <span style="color:#ae81ff">19608</span>], [<span style="color:#ae81ff">559</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2078</span>, <span style="color:#ae81ff">44397</span>], [<span style="color:#ae81ff">534</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3438</span>, <span style="color:#ae81ff">47830</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">515</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2139</span>, <span style="color:#ae81ff">39546</span>], [<span style="color:#ae81ff">603</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6460</span>, <span style="color:#ae81ff">49953</span>], [<span style="color:#ae81ff">234</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6824</span>, <span style="color:#ae81ff">12579</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">805</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8793</span>, <span style="color:#ae81ff">36465</span>], [<span style="color:#ae81ff">245</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5886</span>, <span style="color:#ae81ff">21077</span>], [<span style="color:#ae81ff">190</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7658</span>, <span style="color:#ae81ff">20396</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">392</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7053</span>, <span style="color:#ae81ff">19739</span>], [<span style="color:#ae81ff">609</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5399</span>, <span style="color:#ae81ff">39959</span>], [<span style="color:#ae81ff">479</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8172</span>, <span style="color:#ae81ff">45734</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">321</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7102</span>, <span style="color:#ae81ff">41224</span>], [<span style="color:#ae81ff">720</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4487</span>, <span style="color:#ae81ff">11055</span>], [<span style="color:#ae81ff">208</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1897</span>, <span style="color:#ae81ff">15237</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">890</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4427</span>, <span style="color:#ae81ff">35168</span>], [<span style="color:#ae81ff">513</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5106</span>, <span style="color:#ae81ff">45849</span>], [<span style="color:#ae81ff">666</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1137</span>, <span style="color:#ae81ff">23725</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">755</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6732</span>, <span style="color:#ae81ff">39995</span>], [<span style="color:#ae81ff">589</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6421</span>, <span style="color:#ae81ff">43716</span>], [<span style="color:#ae81ff">866</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3265</span>, <span style="color:#ae81ff">30017</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">416</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6540</span>, <span style="color:#ae81ff">34979</span>], [<span style="color:#ae81ff">840</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1305</span>, <span style="color:#ae81ff">18242</span>], [<span style="color:#ae81ff">731</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6844</span>, <span style="color:#ae81ff">13781</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">561</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2728</span>, <span style="color:#ae81ff">10298</span>], [<span style="color:#ae81ff">863</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5953</span>, <span style="color:#ae81ff">23132</span>], [<span style="color:#ae81ff">204</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4208</span>, <span style="color:#ae81ff">27492</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">158</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8701</span>, <span style="color:#ae81ff">12720</span>], [<span style="color:#ae81ff">802</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4740</span>, <span style="color:#ae81ff">16628</span>], [<span style="color:#ae81ff">491</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6874</span>, <span style="color:#ae81ff">29057</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">531</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4829</span>, <span style="color:#ae81ff">29205</span>], [<span style="color:#ae81ff">363</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4775</span>, <span style="color:#ae81ff">41711</span>], [<span style="color:#ae81ff">319</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9206</span>, <span style="color:#ae81ff">46164</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">317</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9270</span>, <span style="color:#ae81ff">18290</span>], [<span style="color:#ae81ff">680</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5136</span>, <span style="color:#ae81ff">12009</span>], [<span style="color:#ae81ff">880</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2940</span>, <span style="color:#ae81ff">34900</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">162</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2587</span>, <span style="color:#ae81ff">49881</span>], [<span style="color:#ae81ff">997</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5265</span>, <span style="color:#ae81ff">20890</span>], [<span style="color:#ae81ff">485</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9395</span>, <span style="color:#ae81ff">23048</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">867</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1652</span>, <span style="color:#ae81ff">18926</span>], [<span style="color:#ae81ff">691</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7844</span>, <span style="color:#ae81ff">11180</span>], [<span style="color:#ae81ff">355</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5990</span>, <span style="color:#ae81ff">13172</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">923</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2018</span>, <span style="color:#ae81ff">23110</span>], [<span style="color:#ae81ff">214</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4719</span>, <span style="color:#ae81ff">23005</span>], [<span style="color:#ae81ff">921</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9528</span>, <span style="color:#ae81ff">29351</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">349</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7957</span>, <span style="color:#ae81ff">20161</span>], [<span style="color:#ae81ff">470</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1889</span>, <span style="color:#ae81ff">46170</span>], [<span style="color:#ae81ff">244</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6106</span>, <span style="color:#ae81ff">23879</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">419</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5440</span>, <span style="color:#ae81ff">43576</span>], [<span style="color:#ae81ff">930</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1123</span>, <span style="color:#ae81ff">29859</span>], [<span style="color:#ae81ff">151</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5759</span>, <span style="color:#ae81ff">23405</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">843</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6770</span>, <span style="color:#ae81ff">36558</span>], [<span style="color:#ae81ff">574</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6171</span>, <span style="color:#ae81ff">33778</span>], [<span style="color:#ae81ff">772</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1073</span>, <span style="color:#ae81ff">44718</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">932</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4037</span>, <span style="color:#ae81ff">40088</span>], [<span style="color:#ae81ff">848</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5813</span>, <span style="color:#ae81ff">27304</span>], [<span style="color:#ae81ff">194</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6016</span>, <span style="color:#ae81ff">39770</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">966</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6789</span>, <span style="color:#ae81ff">14217</span>], [<span style="color:#ae81ff">219</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6849</span>, <span style="color:#ae81ff">40922</span>], [<span style="color:#ae81ff">352</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6046</span>, <span style="color:#ae81ff">18558</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">794</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">8254</span>, <span style="color:#ae81ff">29748</span>], [<span style="color:#ae81ff">618</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5887</span>, <span style="color:#ae81ff">15535</span>], [<span style="color:#ae81ff">202</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9288</span>, <span style="color:#ae81ff">26590</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">611</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4341</span>, <span style="color:#ae81ff">46682</span>], [<span style="color:#ae81ff">155</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7909</span>, <span style="color:#ae81ff">16654</span>], [<span style="color:#ae81ff">935</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5739</span>, <span style="color:#ae81ff">39342</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">998</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">6538</span>, <span style="color:#ae81ff">24363</span>], [<span style="color:#ae81ff">125</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5679</span>, <span style="color:#ae81ff">36725</span>], [<span style="color:#ae81ff">507</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7074</span>, <span style="color:#ae81ff">15475</span>], 
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">699</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">5836</span>, <span style="color:#ae81ff">47549</span>]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>B <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>]]
</span></span><span style="display:flex;"><span>B <span style="color:#f92672">=</span> matrix(B)
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>    A <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>],[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], cof_t[i][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]]
</span></span><span style="display:flex;"><span>    A <span style="color:#f92672">=</span> matrix(A)
</span></span><span style="display:flex;"><span>    C <span style="color:#f92672">=</span> A <span style="color:#f92672">^</span> (<span style="color:#ae81ff">200000</span><span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> B
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">+=</span> C[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> str(s)[<span style="color:#f92672">-</span><span style="color:#ae81ff">2000</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">1000</span>]
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> unhexlify(md5(s<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest())
</span></span><span style="display:flex;"><span>check <span style="color:#f92672">=</span> sha256(key)<span style="color:#f92672">.</span>hexdigest()
</span></span><span style="display:flex;"><span>verify <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2cf44ec396e3bb9ed0f2f3bdbe4fab6325ae9d9ec3107881308156069452a6d5&#39;</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;s= </span><span style="color:#e6db74">{</span>s<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;key = </span><span style="color:#e6db74">{</span>key<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;hash(key) = </span><span style="color:#e6db74">{</span>check<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;check = </span><span style="color:#e6db74">{</span>check<span style="color:#f92672">==</span>verify<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><p>运行sagemath脚本得到：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>s= 8365222366127410597598169954399481033882921410074214649102398062373189165630613993923060190128768377015697889610969869189338768501949778819512483009804114510646333513147157016729806311717181191848898389803672575716843797638777123435881498143998689577186959772296072473194533856870919617472555638920296793205581043222881816090693269730028856738454951305575065708823347157677411074157254186955326531403441609073128679935513392779152628590893913048822608749327034655805831509883357484164977115164240733564895591006693108254829407400850621646091808483228634435805213269066211974452289769022399418497986464430356041737753404266468993201044272042844144895601296459104534111416147795404108912440106970848660340526207025880755825643455720871621993251258247195860214917957713359490024807893442884343732717743882154397539800059579470352302688717025991780505564794824908605015195865226780305658376169579983423732703921876787723921599023795922881747318116849413935343800909756656082327558085457335537828343666748
</span></span><span style="display:flex;"><span>key = b&#39;S29O\x9a\xf3Z\x87\xe5\xbc{?D`xB&#39;
</span></span><span style="display:flex;"><span>hash(key) = 2cf44ec396e3bb9ed0f2f3bdbe4fab6325ae9d9ec3107881308156069452a6d5
</span></span><span style="display:flex;"><span>check = True
</span></span></code></pre></div><p>现在已经获取到了密钥key，使用python进行aes解密即可。</p>
<blockquote>
<p><strong>注意：！！！</strong></p>
<p>如果使用的是Python3.10版本，可能会出现报错：</p>
<p><code>SystemError: PY_SSIZE_T_CLEAN macro must be defined for '#' formats</code></p>
<p>这种情况是由于pycrypto库导致的问题，进行求解可以尝试安装miniconda创建python虚拟环境，切换到python3.8安装pycrypto库进行求解就可以正常求解</p>
</blockquote>
<p>求解python脚本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> md5, sha256
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> binascii <span style="color:#f92672">import</span> unhexlify
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;836522236612741059759816995439948103388292141007421464910239806237318916563061399392306019012876837701569788</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">96109698691893387685019497788195124830098041145106463335131471570167298063117171811918488983898036725757168437976</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">38777123435881498143998689577186959772296072473194533856870919617472555638920296793205581043222881816090693269730</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">02885673845495130557506570882334715767741107415725418695532653140344160907312867993551339277915262859089391304882</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">26087493270346558058315098833574841649771151642407335648955910066931082548294074008506216460918084832286344358052</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">13269066211974452289769022399418497986464430356041737753404266468993201044272042844144895601296459104534111416147</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">79540410891244010697084866034052620702588075582564345572087162199325125824719586021491795771335949002480789344288</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">43437327177438821543975398000595794703523026887170259917805055647948249086050151958652267803056583761695799834237</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">32703921876787723921599023795922881747318116849413935343800909756656082327558085457335537828343666748&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> unhexlify(md5(s<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest())
</span></span><span style="display:flex;"><span>aes <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key,AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;4f12b3a3eadc4146386f4732266f02bd03114a404ba4cb2dabae213ecec451c9d52c70dc3d25154b5af8a304afafed87&#39;</span>
</span></span><span style="display:flex;"><span>print(aes<span style="color:#f92672">.</span>decrypt(unhexlify(c))<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>))
</span></span></code></pre></div><p>运行脚本即可得到相应的flag: <code>b'flag{519427b3-d104-4c34-a29d-5a7c128031ff}'</code></p>
<h3 id="whereiscode" class="relative group">whereiscode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#whereiscode" aria-label="Anchor">#</a></span></h3>
<blockquote>
<p>这道题目当时是找到文章了但是当时去看密码学题目了，没有细看这道题目</p>
</blockquote>
<p>题目给到了一个apk程序文件，但是主程序里面没有程序的源代码：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829185549101.png" alt="image-20220829185549101" />
      
    </figure>
  

</p>
<p>感觉没有什么思路去处理，对程序的具体结构仔细分析：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829185730520.png" alt="image-20220829185730520" />
      
    </figure>
  

</p>
<p>发现有一个类似于壳的代码程序，尝试进行搜索找到了壳的相关博客和程序源码。</p>
<p>dpt壳程序文章：<a href="https://www.cnblogs.com/luoyesiqiu/p/dpt.html">Android函数抽取壳的实现 - luoyesiqiu - 博客园 (cnblogs.com)</a></p>
<p>dpt壳源码：<a href="https://github.com/luoyesiqiu/dpt-shell">luoyesiqiu/dpt-shell: Android函数抽取壳实现 (github.com)</a></p>
<p>下载壳工具的release版本，进行反编译查看dpt.jar java包文件，可以使用jadx进行反编译查看内容，找到dpt函数进行代码逻辑的审计</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829190248720.png" alt="image-20220829190248720" />
      
    </figure>
  

</p>
<p>根据文章，这个壳是一个函数抽取壳会进行函数的抽取壳：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829190759843.png" alt="image-20220829190759843" />
      
    </figure>
  

</p>
<p>文章也把壳运行的整个流程逻辑写出来了：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829190732698.png" alt="image-20220829190732698" />
      
    </figure>
  

</p>
<p>根据文章的信息，这道题目首先的一个子任务就是脱壳，而脱壳目前来说的目标就是对整个壳程序的逻辑进行分析。对整个流程大致分析下，发现主要是对于Dex进行操作，首先可以在dpt函数中搜索Dex关键字来定位到函数位置：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829191309699.png" alt="image-20220829191309699" />
      
    </figure>
  

</p>
<p>找到一个关键的函数，跟进这个函数，可以找到些许信息</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829191405666.png" alt="image-20220829191405666" />
      
    </figure>
  

</p>
<p>这个函数打开了一个<code>OoooooOooo</code>的文件，这是一个关键的文件信息，可能依据文章中的逻辑找到原来字节码的存储位置。这个函数不长，简单来说就是对原有的Dex进行提取，然后将提取的Dex写入到这个文件中，主要是写入操作的具体实现</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829192021242.png" alt="image-20220829192021242" />
      
    </figure>
  

</p>
<p>跟进<code>writeMultiDexCode</code>查看内部实现情况：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220829192849282.png" alt="image-20220829192849282" />
      
    </figure>
  

</p>
<p>感觉是比较类似于pe结构的实现方式，也就是找到相应的位置进行求解</p>
<p>应该就是类似的一种结构，知道相应的函数偏移位置和相应的数据大小来对dex文件的函数进行抽取，根据这个原理可以进行PE文件结构类似的操作方式进行处理。编写一个小的程序将抽取出来的数据重新填充到相应的位置中。</p>
<p>可以编写一个python脚本进行脱壳处理：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> struct <span style="color:#f92672">import</span> unpack
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;./classes2.dex&#39;</span>,<span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;./OoooooOooo&#39;</span>, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    raw <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;version = </span><span style="color:#e6db74">{</span>unpack(<span style="color:#e6db74">&#39;&lt;H&#39;</span>,raw[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">2</span>])[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;dexcount = </span><span style="color:#e6db74">{</span>unpack(<span style="color:#e6db74">&#39;&lt;H&#39;</span>,raw[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">4</span>])[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;dexCodesIndex1 = </span><span style="color:#e6db74">{</span>unpack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>,raw[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">8</span>])[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;dexCodesIndex2 = </span><span style="color:#e6db74">{</span>unpack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>,raw[<span style="color:#ae81ff">8</span>:<span style="color:#ae81ff">12</span>])[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>pos <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(<span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>    method_index <span style="color:#f92672">=</span> unpack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>,raw[pos:pos<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>])[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">+=</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    offset_dex <span style="color:#f92672">=</span> unpack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>,raw[pos:pos<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>])[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">+=</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    instruction_data_size <span style="color:#f92672">=</span> unpack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>,raw[pos:pos<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>])[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">+=</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    instruction_data <span style="color:#f92672">=</span> raw[pos:pos<span style="color:#f92672">+</span>instruction_data_size]
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">+=</span> instruction_data_size
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> data[:offset_dex]<span style="color:#f92672">+</span>instruction_data <span style="color:#f92672">+</span> data[offset_dex<span style="color:#f92672">+</span>instruction_data_size:]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> pos <span style="color:#f92672">==</span> len(raw):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;./classes2_dump.dex&#39;</span>, <span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(data)
</span></span></code></pre></div><p>脱壳后的程序，可以使用dex2jar程序进行解包，可以得到一个jar包程序：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830160534943.png" alt="image-20220830160534943" />
      
    </figure>
  

</p>
<p>可以直接解压得到一个文件夹，文件夹里面含有程序的class文件：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830160400390.png" alt="image-20220830160400390" />
      
    </figure>
  

</p>
<p>这个文件结构是Android程序包的文件结构，我们关注的点应该就是com文件夹，进入到com\example\nothingcode文件夹中：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830161024487.png" alt="image-20220830161024487" />
      
    </figure>
  

</p>
<p>这两个核心文件应该就是程序的主要文件，使用jd-gui工具进行java字节码文件的反编译来获取到java源码文件来看到程序的真实代码：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830161253724.png" alt="image-20220830161253724" />
      
    </figure>
  

</p>
<p>直接将程序保存成一个java源代码文件</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830161338787.png" alt="image-20220830161338787" />
      
    </figure>
  

</p>
<p>点击Save来保存反编译的源码</p>
<p>使用java ide进行源码的审计，打开生成的源代码文件，一看多少会有些惊讶：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830161646007.png" alt="image-20220830161646007" />
      
    </figure>
  

</p>
<p>有很多混淆和switch，应该是控制流平坦化的方式进行代码混淆的。这种混淆方式主要是由于一个发生器来形成switch结构，来混淆整个程序的主要流程结构。这种混淆的解决方式主要是脚本去混淆和静态代码审计来获取到主要的程序流程。</p>
<p>尝试寻找些未进行混淆的字符串，来确定大致的逻辑特征：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830162651236.png" alt="image-20220830162651236" />
      
    </figure>
  

</p>
<p>可以看出flag的数据应该是位于password的输入位置，往下继续寻找发现：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830224828585.png" alt="image-20220830224828585" />
      
    </figure>
  

</p>
<p>发现，check函数对str2和str3进行了处理，而str2和str3就对应的是两个输入框的内容，根据一般输入行的原理，应该是第一个输入行是用户名，而第二个输入行是密码。进入到check函数中一探究竟：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830225238183.png" alt="image-20220830225238183" />
      
    </figure>
  

</p>
<p>字符串str2有一个等于判断，判断str2是不是等于<code>“helloctf”</code> 这显然像是一个用户名，而不是密码。由于密码是flag这个设定，所以这个str2的形式显然不像是flag的形式。下面寻找字符串str3的操作：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830230118538.png" alt="image-20220830230118538" />
      
    </figure>
  

</p>
<p>找到str3的相关操作，并且找到一组数据，暂时不清楚这组数据有什么用。这个操作显然是把str3转成一个Int数组的操作，跟进函数查看具体操作情况：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830230758071.png" alt="image-20220830230758071" />
      
    </figure>
  

</p>
<p>函数内部有两个操作，一个是判断长度的操作，另一个是除法操作。应该是进行Int数组的初始化处理，继续探究后续操作：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830231328844.png" alt="image-20220830231328844" />
      
    </figure>
  

</p>
<p>进行大端序处理的操作，以及后面有迭代的操作，根据目前分析的情况。可以判断这个函数就是将字符串以大端序的方式转成Int数组。</p>
<p>这个函数分析完毕继续探究以下的内容：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220830231925973.png" alt="image-20220830231925973" />
      
    </figure>
  

</p>
<p>发现非常有趣的特征，一个特征是<code>&lt;32</code>说明可能有32轮次，后面两个运算方程。这些特征和TEA加密算法的特征类似。尝试进行TEA算法的比对，TEA加密算法有32轮次加密并且每轮加密的算法也是相应的一致。由此可以判断这个加密算法应该就是TEA加密算法。</p>
<p>现在找到了加密算法，一个加密算法应该有相应的密钥和相应的密文以及明文。由于我们输入的内容就是要加密的明文，因此找到密文和密钥就可能求解出此题。进行寻找相关信息：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220831113843486.png" alt="image-20220831113843486" />
      
    </figure>
  

</p>
<p>可以大致看出这个数据像是密文的，之前找到的四个成员的数组数据比较符号TEA加密算法的密钥形式，据此推断那个数据应该就是密钥。而且数据只对Int数组进行了加密前面两个成员。没有加密其他成员。</p>
<p>可以大致总结下，加密的大致逻辑：</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/images/2022_WDB_QL-writeup/image-20220831115650012.png" alt="image-20220831115650012" />
      
    </figure>
  

</p>
<p>根据整合的逻辑可以编写脚本进行求解：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> ctypes <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(v, k):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> c_int32(v[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> c_int32(v[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    delta <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1640531527</span>
</span></span><span style="display:flex;"><span>    total <span style="color:#f92672">=</span> c_uint32(delta <span style="color:#f92672">*</span> <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>):
</span></span><span style="display:flex;"><span>        y<span style="color:#f92672">.</span>value <span style="color:#f92672">-=</span> ((x<span style="color:#f92672">.</span>value <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">^</span> (x<span style="color:#f92672">.</span>value <span style="color:#f92672">+</span> total<span style="color:#f92672">.</span>value) <span style="color:#f92672">^</span> ((x<span style="color:#f92672">.</span>value <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>        x<span style="color:#f92672">.</span>value <span style="color:#f92672">-=</span> ((y<span style="color:#f92672">.</span>value <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">^</span> (y<span style="color:#f92672">.</span>value <span style="color:#f92672">+</span> total<span style="color:#f92672">.</span>value) <span style="color:#f92672">^</span> ((y<span style="color:#f92672">.</span>value <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>        total<span style="color:#f92672">.</span>value <span style="color:#f92672">-=</span> delta
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x<span style="color:#f92672">.</span>value, y<span style="color:#f92672">.</span>value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c_bytes <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span><span style="color:#ae81ff">63</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">69</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">126</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">32</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">49</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">121</span>, <span style="color:#ae81ff">107</span>, <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">99</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(c_bytes),<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>    num <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>        num <span style="color:#f92672">+=</span> hex((c_bytes[i<span style="color:#f92672">+</span>v] <span style="color:#f92672">+</span> <span style="color:#ae81ff">256</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">256</span>)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    num <span style="color:#f92672">=</span> int(num,<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> num <span style="color:#f92672">&lt;</span> pow(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">31</span>):
</span></span><span style="display:flex;"><span>        c<span style="color:#f92672">.</span>append(num)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        c<span style="color:#f92672">.</span>append(num<span style="color:#f92672">-</span>pow(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">32</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2023708229</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">158607964</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2120859654</span>, <span style="color:#ae81ff">1167043672</span>]
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> list(decrypt(c,key)) <span style="color:#f92672">+</span> c[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> m:
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> [int(hex(i)[<span style="color:#ae81ff">2</span>:][v:v<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>],<span style="color:#ae81ff">16</span>) <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">2</span>)]
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">+=</span> bytes(f)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;flag</span><span style="color:#ae81ff">{{</span><span style="color:#e6db74">{</span>flag<span style="color:#f92672">.</span>decode()<span style="color:#e6db74">}</span><span style="color:#ae81ff">}}</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><p>运行得到flag：<code>flag{Givey0urf1Agykoc}</code></p>
<p>这道题目的脱壳方法也很多种，可以使用frida进行hook，然后让程序运行到解密的位置进行内存dump来进行脱壳。当然还有另一个方法也可以进行脱壳，在网上搜索到的一篇博客中有详细说明：<a href="https://blog.csdn.net/m0_64604636/article/details/121885541">(191条消息) Android脱壳之整体脱壳原理与实践，今天带你详细了解各组件原理_m0_64604636的博客-CSDN博客_android 脱壳</a></p>

      </div>
      <script>

        var liked_article = false

        if (typeof auth !== 'undefined') {
          var oid = "views_posts\\2022_WDB_QL-writeup.md"
          var id = oid ? oid.replaceAll("/", "-") : oid

          var viewed = localStorage.getItem(id);

          if (!viewed) {
            auth.signInAnonymously()
              .then(() => {
                var docRef = db.collection('views').doc(id)
                localStorage.setItem(id, true);
                docRef.get().then((doc) => {
                  if (doc.exists) {
                    db.collection('views').doc(id).update({
                      views: firebase.firestore.FieldValue.increment(1)
                    });
                  } else {
                    db.collection('views').doc(id).set({ views: 1 })
                  }
                }).catch((error) => {
                  console.log("Error getting document:", error);
                });
              })
              .catch((error) => {
                var errorCode = error.code;
                var errorMessage = error.message;
                console.error(errorCode, errorMessage)
              });
          }

          var oid_likes = "likes_posts\\2022_WDB_QL-writeup.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes

          var liked = localStorage.getItem(id_likes);

          if (liked) {
            liked_article = true
            document.querySelectorAll("button[id='likes_button']")[0].innerText = "Remove Like"
          }

        }

        function like_article(id_likes) {
          console.log("add")
          liked_article = true
          localStorage.setItem(id_likes, true);
          document.querySelectorAll("button[id='likes_button']")[0].innerText = "Remove Like"
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 1 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function remove_like_article(id_likes) {
          console.log("remove")
          liked_article = false
          localStorage.setItem(id_likes, false);
          document.querySelectorAll("button[id='likes_button']")[0].innerText = "Like"
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(-1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 0 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function process_article() {
          var oid_likes = "likes_posts\\2022_WDB_QL-writeup.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes
          if (!liked_article) {
            like_article(id_likes)
          } else {
            remove_like_article(id_likes)
          }
        }
      </script>
  </section>
  <footer class="pt-8 max-w-prose print:hidden">
    
  <div class="flex">
    
      
      
        
        <img
          class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
          width="96"
          height="96"
          alt="OolongCode"
          src="/img/orca_hua93937f76bd5e462e54a483861805696_158669_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
          Author
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          OolongCode
        </div>
      
      
        <div class="text-sm text-neutral-700 dark:text-neutral-400">OolongCode and OrcasCode&rsquo;s CyberSpace!</div>
      
      <div class="text-2xl sm:text-lg">
</div>
    </div>
  </div>


    
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.codetea.top/posts/2022_wdb_ql-writeup/&amp;title=2022%20%e7%bd%91%e9%bc%8e%e6%9d%af%20%e9%9d%92%e9%be%99%e7%bb%84%20Writeup"
          title="Share on LinkedIn"
          aria-label="Share on LinkedIn"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://twitter.com/intent/tweet/?url=https://www.codetea.top/posts/2022_wdb_ql-writeup/&amp;text=2022%20%e7%bd%91%e9%bc%8e%e6%9d%af%20%e9%9d%92%e9%be%99%e7%bb%84%20Writeup"
          title="Tweet on Twitter"
          aria-label="Tweet on Twitter"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</a
        >
      
    
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.codetea.top/posts/2022_wdb_ql-writeup/&amp;description=2022%20%e7%bd%91%e9%bc%8e%e6%9d%af%20%e9%9d%92%e9%be%99%e7%bb%84%20Writeup"
          title="Pin on Pinterest"
          aria-label="Pin on Pinterest"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://reddit.com/submit/?url=https://www.codetea.top/posts/2022_wdb_ql-writeup/&amp;resubmit=true&amp;title=2022%20%e7%bd%91%e9%bc%8e%e6%9d%af%20%e9%9d%92%e9%be%99%e7%bb%84%20Writeup"
          title="Submit to Reddit"
          aria-label="Submit to Reddit"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.facebook.com/sharer/sharer.php?u=https://www.codetea.top/posts/2022_wdb_ql-writeup/&amp;quote=2022%20%e7%bd%91%e9%bc%8e%e6%9d%af%20%e9%9d%92%e9%be%99%e7%bb%84%20Writeup"
          title="Share on Facebook"
          aria-label="Share on Facebook"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="mailto:?body=https://www.codetea.top/posts/2022_wdb_ql-writeup/&amp;subject=2022%20%e7%bd%91%e9%bc%8e%e6%9d%af%20%e9%9d%92%e9%be%99%e7%bb%84%20Writeup"
          title="Send via email"
          aria-label="Send via email"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</a
        >
      
    
  </section>


    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/posts/xctf-reverse-advanced_daliy_001/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >攻防世界进阶区日常训练001</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-04-23 15:14:39 &#43;0800 CST">April 23, 2022</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group" href="/posts/xctf-reverse_daliy_002/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >攻防世界 RE 日常练习 002</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-09-04 11:30:27 &#43;0800 CST">September 4, 2022</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

        
          <div
            class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"
          >
            <a
              href="#the-top"
              class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
    <ul class="flex flex-col list-none sm:flex-row">
      
      <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/categories/"
          title="Categories">Categories</a>
      </li>
      
      <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
        <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/tags/"
          title="Tags">Tags</a>
      </li>
      
    </ul>
  </nav>
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2022
      OolongCode
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://nunocoracao.github.io/blowfish/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.1d5a3f4a9583d31668d777478074c0526be93b07cc79f303dce0ecc502226b04072b27e78185a927a25fd226da1de5a457c13cb89c85596512bd500006ee7602.js" integrity="sha512-HVo/SpWD0xZo13dHgHTAUmvpOwfMefMD3ODsxQIiawQHKyfngYWpJ6Jf0ibaHeWkV8E8uJyFWWUSvVAABu52Ag=="></script>
  
  
</footer><div
  id="search-wrapper"
  class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://www.codetea.top/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
