<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="OrcasCode">
<meta name="description" content="XCTF-REVERSE-高手区-1 writeup有段时间没有刷题了，刷刷题找找手感
0x0 answer_to_everything使用DIE查看程序信息
程序没有壳，而且是64位。然后看看文件长什么样，静态分析的时刻来临：
发现关键函数，跟进这个函数
__int64 __fastcall not_the_flag(int a1) { if ( a1 == 42 ) puts(&#34;Cipher from Bill \nSubmit without any tags\n#kdudpeh&#34;); else puts(&#34;YOUSUCK&#34;); return 0LL; } 根据题目要求，应该是要对一个字段进行sha1加密，仔细观察逆向程序，发现应该是对kdudpeh进行sha1加密
使用python进行sha1加密得：
80ee2a3fe31da904c596d993f7f1de4827c1450a 故本题flag为
flag{80ee2a3fe31da904c596d993f7f1de4827c1450a} 0x1 elrond32使用DIE查询一下文件信息
32位的exec文件，使用IDA pro打开
定位到main函数的位置
int __cdecl main(int a1, char **a2) { if ( a1 &gt; 1 &amp;&amp; sub_8048414(a2[1], 0) ) { puts(&#34;Access granted&#34;); sub_8048538(a2[1]); } else { puts(&#34;Access denied&#34;); } return 0; } 关键函数应该是在sub_8048538(a2[1])函数里面">
<meta name="keywords" content="blog,developer,personal">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="XCTF REVERSE Expert (1) Writeup"/>
<meta name="twitter:description" content="XCTF-REVERSE-高手区-1 writeup有段时间没有刷题了，刷刷题找找手感
0x0 answer_to_everything使用DIE查看程序信息
程序没有壳，而且是64位。然后看看文件长什么样，静态分析的时刻来临：
发现关键函数，跟进这个函数
__int64 __fastcall not_the_flag(int a1) { if ( a1 == 42 ) puts(&#34;Cipher from Bill \nSubmit without any tags\n#kdudpeh&#34;); else puts(&#34;YOUSUCK&#34;); return 0LL; } 根据题目要求，应该是要对一个字段进行sha1加密，仔细观察逆向程序，发现应该是对kdudpeh进行sha1加密
使用python进行sha1加密得：
80ee2a3fe31da904c596d993f7f1de4827c1450a 故本题flag为
flag{80ee2a3fe31da904c596d993f7f1de4827c1450a} 0x1 elrond32使用DIE查询一下文件信息
32位的exec文件，使用IDA pro打开
定位到main函数的位置
int __cdecl main(int a1, char **a2) { if ( a1 &gt; 1 &amp;&amp; sub_8048414(a2[1], 0) ) { puts(&#34;Access granted&#34;); sub_8048538(a2[1]); } else { puts(&#34;Access denied&#34;); } return 0; } 关键函数应该是在sub_8048538(a2[1])函数里面"/>

<meta property="og:title" content="XCTF REVERSE Expert (1) Writeup" />
<meta property="og:description" content="XCTF-REVERSE-高手区-1 writeup有段时间没有刷题了，刷刷题找找手感
0x0 answer_to_everything使用DIE查看程序信息
程序没有壳，而且是64位。然后看看文件长什么样，静态分析的时刻来临：
发现关键函数，跟进这个函数
__int64 __fastcall not_the_flag(int a1) { if ( a1 == 42 ) puts(&#34;Cipher from Bill \nSubmit without any tags\n#kdudpeh&#34;); else puts(&#34;YOUSUCK&#34;); return 0LL; } 根据题目要求，应该是要对一个字段进行sha1加密，仔细观察逆向程序，发现应该是对kdudpeh进行sha1加密
使用python进行sha1加密得：
80ee2a3fe31da904c596d993f7f1de4827c1450a 故本题flag为
flag{80ee2a3fe31da904c596d993f7f1de4827c1450a} 0x1 elrond32使用DIE查询一下文件信息
32位的exec文件，使用IDA pro打开
定位到main函数的位置
int __cdecl main(int a1, char **a2) { if ( a1 &gt; 1 &amp;&amp; sub_8048414(a2[1], 0) ) { puts(&#34;Access granted&#34;); sub_8048538(a2[1]); } else { puts(&#34;Access denied&#34;); } return 0; } 关键函数应该是在sub_8048538(a2[1])函数里面" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.codetea.top/posts/xctf-reverse-expert-1_writeup/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-28T19:33:49+08:00" />
<meta property="article:modified_time" content="2022-01-28T19:33:49+08:00" />




  <title>OPdbg</title>

  
  <link rel="canonical" href="https://www.codetea.top/posts/xctf-reverse-expert-1_writeup/">
  

  <link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.6b1a4fbc48955b72aea7913e43fabeb45e8bc120da5aa41b598dd33adcac4b59.css" integrity="sha256-axpPvEiVW3Kup5E&#43;Q/q&#43;tF6LwSDaWqQbWY3TOtysS1k=" crossorigin="anonymous" media="screen" />





  
  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css" integrity="sha256-OeQafxa9&#43;MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin="anonymous" media="screen" />
  



   





  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">


  

  <meta name="generator" content="Hugo 0.101.0" />


  

<link href="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.5.1/styles/atom-one-dark-reasonable.min.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.5.1/languages/armasm.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.5.1/languages/mipsasm.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.5.1/languages/wasm.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.5.1/languages/x86asm.min.js"></script>
<script>hljs.highlightAll();</script>
</head>







<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      OPdbg
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/categories/">Categories</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/tags/">Tags</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/link/">Link</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://www.codetea.top/posts/xctf-reverse-expert-1_writeup/">
              XCTF REVERSE Expert (1) Writeup
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2022-01-28T19:33:49&#43;08:00">
                January 28, 2022
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              5-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa fa-folder" aria-hidden="true"></i>
    <a href="/categories/practice/">practice</a></div>

          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/ctf/">ctf</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/writeup/">writeup</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/reverse/">reverse</a>
    </span></div>

        </div>
      </header>

      <div>
        
        <h1 id="xctf-reverse-高手区-1-writeup">
  XCTF-REVERSE-高手区-1 writeup
  <a class="heading-link" href="#xctf-reverse-%e9%ab%98%e6%89%8b%e5%8c%ba-1-writeup">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>有段时间没有刷题了，刷刷题找找手感</p>
<h2 id="0x0-answer_to_everything">
  0x0 answer_to_everything
  <a class="heading-link" href="#0x0-answer_to_everything">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>使用DIE查看程序信息</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211031104627471.png" alt="image-20211031104627471"></p>
<p>程序没有壳，而且是64位。然后看看文件长什么样，静态分析的时刻来临：</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211031104740182.png" alt="image-20211031104740182"></p>
<p>发现关键函数，跟进这个函数</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="font-weight:bold">__int64</span> <span style="font-weight:bold">__fastcall</span> not_the_flag(<span style="">int</span> a1)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> ( a1 == 42 )
</span></span><span style="display:flex;"><span>    puts(<span style="font-style:italic">&#34;Cipher from Bill </span><span style="font-weight:bold;font-style:italic">\n</span><span style="font-style:italic">Submit without any tags</span><span style="font-weight:bold;font-style:italic">\n</span><span style="font-style:italic">#kdudpeh&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    puts(<span style="font-style:italic">&#34;YOUSUCK&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> 0LL;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>根据题目要求，应该是要对一个字段进行sha1加密，仔细观察逆向程序，发现应该是对<code>kdudpeh</code>进行sha1加密</p>
<p>使用python进行sha1加密得：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>80ee2a3fe31da904c596d993f7f1de4827c1450a
</span></span></code></pre></div><p>故本题flag为</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>flag{80ee2a3fe31da904c596d993f7f1de4827c1450a}
</span></span></code></pre></div><h2 id="0x1-elrond32">
  0x1 elrond32
  <a class="heading-link" href="#0x1-elrond32">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>使用DIE查询一下文件信息</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211031105318823.png" alt="image-20211031105318823"></p>
<p>32位的exec文件，使用IDA pro打开</p>
<p>定位到main函数的位置</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="">int</span> <span style="font-weight:bold">__cdecl</span> main(<span style="">int</span> a1, <span style="">char</span> **a2)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> ( a1 &gt; 1 &amp;&amp; sub_8048414(a2[1], 0) )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    puts(<span style="font-style:italic">&#34;Access granted&#34;</span>);
</span></span><span style="display:flex;"><span>    sub_8048538(a2[1]);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    puts(<span style="font-style:italic">&#34;Access denied&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>关键函数应该是在<code>sub_8048538(a2[1])</code>函数里面</p>
<p>跟进到<code>sub_8048538(a2[1])</code>函数</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="">int</span> <span style="font-weight:bold">__cdecl</span> sub_8048538(<span style="">int</span> a1)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">int</span> v2[33]; <span style="font-style:italic">// [esp+18h] [ebp-A0h] BYREF
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">int</span> i; <span style="font-style:italic">// [esp+9Ch] [ebp-1Ch]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>
</span></span><span style="display:flex;"><span>  qmemcpy(v2, &amp;unk_8048760, <span style="font-weight:bold">sizeof</span>(v2));
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">for</span> ( i = 0; i &lt;= 32; ++i )
</span></span><span style="display:flex;"><span>    putchar(v2[i] ^ *(<span style="">char</span> *)(a1 + i % 8));
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> putchar(10);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>发现和参数a2有关联，需要寻找<code>a2</code>的相关线索</p>
<p>发现<code>if</code>判断那个位置的函数有对<code>a2</code>数据进行处理，跟进那个函数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="">int</span> <span style="font-weight:bold">__cdecl</span> sub_8048414(_BYTE *a1, <span style="">int</span> a2)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">int</span> result; <span style="font-style:italic">// eax
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">switch</span> ( a2 )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 0:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 105 )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_19;
</span></span><span style="display:flex;"><span>      result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 1:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 101 )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_19;
</span></span><span style="display:flex;"><span>      result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 3:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 110 )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_19;
</span></span><span style="display:flex;"><span>      result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 4:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 100 )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_19;
</span></span><span style="display:flex;"><span>      result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 5:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 97 )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_19;
</span></span><span style="display:flex;"><span>      result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 6:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 103 )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_19;
</span></span><span style="display:flex;"><span>      result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 7:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 115 )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_19;
</span></span><span style="display:flex;"><span>      result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">case</span> 9:
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( *a1 == 114 )
</span></span><span style="display:flex;"><span>LABEL_19:
</span></span><span style="display:flex;"><span>        result = sub_8048414(a1 + 1, 7 * (a2 + 1) % 11);
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>        result = 0;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">default</span>:
</span></span><span style="display:flex;"><span>      result = 1;
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>对于<code>a2</code>进行递归变化，结合对于<code>a2</code>处理的函数，可以编写个小程序来生成flag</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="">#include</span> <span style="">&lt;iostream&gt;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>
</span></span><span style="display:flex;"><span><span style="">int</span> main()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">int</span> v2[]
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    0x0F, 0x1F,  0x04, 0x09, 0x1C, 0x12,  0x42,  0x09,  0x0C, 0x44, 
</span></span><span style="display:flex;"><span>    0x0D, 0x07,  0x09, 0x06, 0x2D, 0x37,  0x59,  0x1E,  0x00, 0x59, 
</span></span><span style="display:flex;"><span>    0x0F, 0x08,  0x1C, 0x23, 0x36, 0x07,  0x55,  0x02,  0x0C, 0x08, 
</span></span><span style="display:flex;"><span>    0x41, 0x0A,  0x14
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="">int</span> key[]
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    105,115,101,110,103,97,114,100
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">for</span>(<span style="">int</span> i = 0;i&lt;33;i++)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    putchar(v2[i]^key[i%8]);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>编译并运行，就能得到flag</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>flag{s0me7hing_S0me7hinG_t0lki3n}
</span></span></code></pre></div><h2 id="0x2-666">
  0x2 666
  <a class="heading-link" href="#0x2-666">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>使用DIE查询一下程序信息：</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211031153424353.png" alt="image-20211031153424353"></p>
<p>64位程序，使用GCC进行编译的无壳程序</p>
<p>使用IDA x64 pro 对程序进行静态分析：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="">int</span> <span style="font-weight:bold">__cdecl</span> main(<span style="">int</span> argc, <span style="font-weight:bold">const</span> <span style="">char</span> **argv, <span style="font-weight:bold">const</span> <span style="">char</span> **envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">char</span> s[240]; <span style="font-style:italic">// [rsp+0h] [rbp-1E0h] BYREF
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">char</span> v5[240]; <span style="font-style:italic">// [rsp+F0h] [rbp-F0h] BYREF
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>
</span></span><span style="display:flex;"><span>  memset(s, 0, 30uLL);
</span></span><span style="display:flex;"><span>  printf(<span style="font-style:italic">&#34;Please Input Key: &#34;</span>);
</span></span><span style="display:flex;"><span>  __isoc99_scanf(<span style="font-style:italic">&#34;%s&#34;</span>, v5);
</span></span><span style="display:flex;"><span>  encode(v5, (<span style="font-weight:bold">__int64</span>)s);
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> ( strlen(v5) == key )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> ( !strcmp(s, enflag) )
</span></span><span style="display:flex;"><span>      puts(<span style="font-style:italic">&#34;You are Right&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>      puts(<span style="font-style:italic">&#34;flag{This_1s_f4cker_flag}&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>关键函数应该是在encode里面，这个程序的基本逻辑就是将输入进行<code>encode</code>函数处理，然后与指定的字符串进行比对来进行验证。</p>
<p>而输入的字符串就是flag数据。</p>
<p>因此，这道题目也就可以非常简单进行处理，也就是对<code>encode</code>函数进行逆向处理就可</p>
<p>首先，还是查看一下<code>encode</code>的内部实现情况：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="">int</span> <span style="font-weight:bold">__fastcall</span> encode(<span style="font-weight:bold">const</span> <span style="">char</span> *a1, <span style="font-weight:bold">__int64</span> a2)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">char</span> v3[104]; <span style="font-style:italic">// [rsp+10h] [rbp-70h]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">int</span> v4; <span style="font-style:italic">// [rsp+78h] [rbp-8h]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">int</span> i; <span style="font-style:italic">// [rsp+7Ch] [rbp-4h]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>
</span></span><span style="display:flex;"><span>  i = 0;
</span></span><span style="display:flex;"><span>  v4 = 0;
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> ( strlen(a1) != key )
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> puts(<span style="font-style:italic">&#34;Your Length is Wrong&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">for</span> ( i = 0; i &lt; key; i += 3 )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    v3[i + 64] = key ^ (a1[i] + 6);
</span></span><span style="display:flex;"><span>    v3[i + 33] = (a1[i + 1] - 6) ^ key;
</span></span><span style="display:flex;"><span>    v3[i + 2] = a1[i + 2] ^ 6 ^ key;
</span></span><span style="display:flex;"><span>    *(_BYTE *)(a2 + i) = v3[i + 64];
</span></span><span style="display:flex;"><span>    *(_BYTE *)(a2 + i + 1LL) = v3[i + 33];
</span></span><span style="display:flex;"><span>    *(_BYTE *)(a2 + i + 2LL) = v3[i + 2];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> a2;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>进行跟踪发现<code>key = 18</code></p>
<p>可以得知我们输入的内容长度为18</p>
<p>根据编码函数编写一个解密器进行程序破解</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="">#include</span> <span style="">&lt;iostream&gt;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>
</span></span><span style="display:flex;"><span><span style="">int</span> main()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">int</span> enflag[] =
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    0x69, 0x7A, 0x77, 0x68, 0x72, 0x6F, 0x7A, 0x22, 0x22, 0x77, 
</span></span><span style="display:flex;"><span>    0x22, 0x76, 0x2E, 0x4B, 0x22, 0x2E, 0x4E, 0x69, 0x00
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="">int</span> key = 0x12;
</span></span><span style="display:flex;"><span>  <span style="">int</span> i = 0;
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">for</span>(i;i&lt;key;i+=3)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    putchar((key^enflag[i])-6);
</span></span><span style="display:flex;"><span>    putchar((enflag[i+1]^key)+6);
</span></span><span style="display:flex;"><span>    putchar((enflag[i+2]^key^6));
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>编译并运行程序就能拿到flag：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>unctf{b66_6b6_66b}
</span></span></code></pre></div><h2 id="0x3-igniteme">
  0x3 IgniteMe
  <a class="heading-link" href="#0x3-igniteme">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>首先是使用DIE进行程序信息的查看：</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211031161028282.png" alt="image-20211031161028282"></p>
<p>32位的PE程序，PE程序可以使用的工具就有很多了，首先还是静态分析：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="">int</span> <span style="font-weight:bold">__cdecl</span> main(<span style="">int</span> argc, <span style="font-weight:bold">const</span> <span style="">char</span> **argv, <span style="font-weight:bold">const</span> <span style="">char</span> **envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">int</span> result; <span style="font-style:italic">// eax
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  size_t i; <span style="font-style:italic">// [esp+4Ch] [ebp-8Ch]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">char</span> v5[8]; <span style="font-style:italic">// [esp+50h] [ebp-88h] BYREF
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">char</span> Str[128]; <span style="font-style:italic">// [esp+58h] [ebp-80h] BYREF
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>
</span></span><span style="display:flex;"><span>  sub_402B30(&amp;unk_446360, <span style="font-style:italic">&#34;Give me your flag:&#34;</span>);
</span></span><span style="display:flex;"><span>  sub_4013F0(sub_403670);
</span></span><span style="display:flex;"><span>  sub_401440(Str, 127);
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> ( strlen(Str) &lt; 0x1E &amp;&amp; strlen(Str) &gt; 4 )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    strcpy(v5, <span style="font-style:italic">&#34;EIS{&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">for</span> ( i = 0; i &lt; strlen(v5); ++i )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">if</span> ( Str[i] != v5[i] )
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">goto</span> LABEL_7;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> ( Str[28] != 125 )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>LABEL_7:
</span></span><span style="display:flex;"><span>      sub_402B30(&amp;unk_446360, <span style="font-style:italic">&#34;Sorry, keep trying! &#34;</span>);
</span></span><span style="display:flex;"><span>      sub_4013F0(sub_403670);
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">return</span> 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> ( (<span style="">unsigned</span> <span style="font-weight:bold">__int8</span>)sub_4011C0(Str) )
</span></span><span style="display:flex;"><span>      sub_402B30(&amp;unk_446360, <span style="font-style:italic">&#34;Congratulations! &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>      sub_402B30(&amp;unk_446360, <span style="font-style:italic">&#34;Sorry, keep trying! &#34;</span>);
</span></span><span style="display:flex;"><span>    sub_4013F0(sub_403670);
</span></span><span style="display:flex;"><span>    result = 0;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    sub_402B30(&amp;unk_446360, <span style="font-style:italic">&#34;Sorry, keep trying!&#34;</span>);
</span></span><span style="display:flex;"><span>    sub_4013F0(sub_403670);
</span></span><span style="display:flex;"><span>    result = 0;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>找到关键加密的位置进行分析</p>
<p>即对函数<code>sub_4011c0(str)</code>进行分析</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="">bool</span> <span style="font-weight:bold">__cdecl</span> sub_4011C0(<span style="">char</span> *Str)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  size_t v2; <span style="font-style:italic">// eax
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">int</span> v3; <span style="font-style:italic">// [esp+50h] [ebp-B0h]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">char</span> Str2[32]; <span style="font-style:italic">// [esp+54h] [ebp-ACh] BYREF
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">int</span> v5; <span style="font-style:italic">// [esp+74h] [ebp-8Ch]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">int</span> v6; <span style="font-style:italic">// [esp+78h] [ebp-88h]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  size_t i; <span style="font-style:italic">// [esp+7Ch] [ebp-84h]
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>  <span style="">char</span> v8[128]; <span style="font-style:italic">// [esp+80h] [ebp-80h] BYREF
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> ( strlen(Str) &lt;= 4 )
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">return</span> 0;
</span></span><span style="display:flex;"><span>  i = 4;
</span></span><span style="display:flex;"><span>  v6 = 0;
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">while</span> ( i &lt; strlen(Str) - 1 )
</span></span><span style="display:flex;"><span>    v8[v6++] = Str[i++];
</span></span><span style="display:flex;"><span>  v8[v6] = 0;
</span></span><span style="display:flex;"><span>  v5 = 0;
</span></span><span style="display:flex;"><span>  v3 = 0;
</span></span><span style="display:flex;"><span>  memset(Str2, 0, <span style="font-weight:bold">sizeof</span>(Str2));
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">for</span> ( i = 0; ; ++i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    v2 = strlen(v8);
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> ( i &gt;= v2 )
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> ( v8[i] &gt;= 97 &amp;&amp; v8[i] &lt;= 122 )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v8[i] -= 32;
</span></span><span style="display:flex;"><span>      v3 = 1;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span> ( !v3 &amp;&amp; v8[i] &gt;= 65 &amp;&amp; v8[i] &lt;= 90 )
</span></span><span style="display:flex;"><span>      v8[i] += 32;
</span></span><span style="display:flex;"><span>    Str2[i] = byte_4420B0[i] ^ sub_4013C0(v8[i]);
</span></span><span style="display:flex;"><span>    v3 = 0;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> strcmp(<span style="font-style:italic">&#34;GONDPHyGjPEKruv{{pj]X@rF&#34;</span>, Str2) == 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>直接就是一个加密算法，直接进行手撸一个解密算法即可：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="">#include</span> <span style="">&lt;iostream&gt;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style="">#include</span> <span style="">&lt;cstring&gt;</span><span style="">
</span></span></span><span style="display:flex;"><span><span style=""></span>
</span></span><span style="display:flex;"><span><span style="">int</span> main()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="">char</span> flag[128]{ 0 };
</span></span><span style="display:flex;"><span>  <span style="">char</span> s[]{
</span></span><span style="display:flex;"><span>  0x0D, 0x13, 0x17, 0x11, 0x02, 0x01, 0x20, 0x1D, 0x0C, 0x02, 
</span></span><span style="display:flex;"><span>  0x19, 0x2F, 0x17, 0x2B, 0x24, 0x1F, 0x1E, 0x16, 0x09, 0x0F, 
</span></span><span style="display:flex;"><span>  0x15, 0x27, 0x13, 0x26, 0x0A, 0x2F, 0x1E, 0x1A, 0x2D, 0x0C, 
</span></span><span style="display:flex;"><span>  0x22, 0x04
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="">char</span> Str[]{ <span style="font-style:italic">&#34;GONDPHyGjPEKruv{{pj]X@rF&#34;</span> };
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">for</span>(<span style="">int</span> i{ 0 };i&lt;strlen(Str);i++)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    flag[i] = ((Str[i]^s[i])-72)^0x55;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">if</span>(flag[i] &gt;= <span style="font-style:italic">&#39;a&#39;</span> &amp;&amp; flag[i] &lt;= <span style="font-style:italic">&#39;z&#39;</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      flag[i] -= 32;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">else</span> <span style="font-weight:bold">if</span>(flag[i] &gt;= <span style="font-style:italic">&#39;A&#39;</span> &amp;&amp; flag[i] &lt;= <span style="font-style:italic">&#39;Z&#39;</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      flag[i] += 32;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  std::cout &lt;&lt; <span style="font-style:italic">&#34;EIS{&#34;</span> &lt;&lt; flag &lt;&lt; <span style="font-style:italic">&#34;}&#34;</span> &lt;&lt; std::endl;
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>编译并运行，就可以得到flag</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>EIS{wadx_tdgk_aihc_ihkn_pjlm}
</span></span></code></pre></div><h2 id="0x4-debug">
  0x4 debug
  <a class="heading-link" href="#0x4-debug">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>使用DIE进行正常的程序信息查询：</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211101080738116.png" alt="image-20211101080738116"></p>
<p>.Net编译的程序，看样子不太友好。面对从未见到过的程序，该怎么做呢？这种情况下，就要使用强大的搜索引擎来寻找答案，经过搜索引擎的帮助，我这边找到了一个工具可以进行.Net程序的逆向——dnSpy</p>
<p>使用dnSpy来进行.Net程序的开心逆向吧！</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211101082430169.png" alt="image-20211101082430169"></p>
<p>dnSpy程序载入页面，dnSpy是一个非常好用的.Net程序和C#程序逆向工具，而且dnSpy的操作方式与Visual Studio非常相似，可以根据Visual Studio的操作模式进行debug。</p>
<p>首先，需要寻找到关键函数和关键代码位置</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211101082804148.png" alt="image-20211101082804148"></p>
<p>经过一番寻找，发现在02000003的位置有存在关键代码，根据关键代码跟进关键函数发现：</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211101083006881.png" alt="image-20211101083006881"></p>
<p>flag就存在在这里，使用断点断在入口函数这里来进行调试，得到：</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211101083207311.png" alt="image-20211101083207311"></p>
<p>得到flag：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>flag{967DDDFBCD32C1F53527C221D9E40A0B}
</span></span></code></pre></div><h2 id="0x5-guess-the-number">
  0x5 Guess-the-Number
  <a class="heading-link" href="#0x5-guess-the-number">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>题目直接给了一个jar程序文件，应该是一个java逆向题目，java逆向和Android逆向类似，故可以使用相似的工具进行反编译：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="font-weight:bold">package</span> <span style="font-weight:bold">defpackage</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">import</span> <span style="font-weight:bold">java.math.BigInteger</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-style:italic">/* renamed from: guess  reason: default package */</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">public</span> <span style="font-weight:bold">class</span> <span style="font-weight:bold">guess</span> {
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">static</span> String XOR(String _str_one, String _str_two) {
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">return</span> <span style="font-weight:bold">new</span> BigInteger(_str_one, 16).xor(<span style="font-weight:bold">new</span> BigInteger(_str_two, 16)).toString(16);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">public</span> <span style="font-weight:bold">static</span> <span style="">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">if</span> (args.length &gt; 0) {
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">if</span> (309137378 == Integer.parseInt(args[0])) {
</span></span><span style="display:flex;"><span>                    <span style="">int</span> my_num = 349763335 + 345736730;
</span></span><span style="display:flex;"><span>                    System.out.println(<span style="font-style:italic">&#34;your flag is: &#34;</span> + XOR(<span style="font-style:italic">&#34;4b64ca12ace755516c178f72d05d7061&#34;</span>, <span style="font-style:italic">&#34;ecd44646cfe5994ebeb35bf922e25dba&#34;</span>));
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                System.err.println(<span style="font-style:italic">&#34;wrong guess!&#34;</span>);
</span></span><span style="display:flex;"><span>                System.exit(1);
</span></span><span style="display:flex;"><span>            } <span style="font-weight:bold">catch</span> (NumberFormatException e) {
</span></span><span style="display:flex;"><span>                System.err.println(<span style="font-style:italic">&#34;please enter an integer \nexample: java -jar guess 12&#34;</span>);
</span></span><span style="display:flex;"><span>                System.exit(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            System.err.println(<span style="font-style:italic">&#34;wrong guess!&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="">int</span> num = 1000000 + 1;
</span></span><span style="display:flex;"><span>            System.exit(1);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>可以直接拖到idea进行参数调试来得到flag:cat:（偷懒小技巧）</p>
<p><img src="/images/XCTF-REVERSE-expert-1_writeup/image-20211101084458531.png" alt="image-20211101084458531"></p>
<p>成功得到flag：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>a7b08c546302cc1fd2a4d48bf2bf2ddb
</span></span></code></pre></div>
      </div>


      <footer>
        


        <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2019 -
    
    2022
     OrcasCode 
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  
  
  <script src="/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js" integrity="sha256-I2BJOV3DaC&#43;ycZZAhylY4S8fJAZ7sJwyeyM&#43;YpDH7aw="></script>
  

  

  

  

  

  

  

  

  

  
</body>

</html>
